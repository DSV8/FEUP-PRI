{
    "id": "26MAaX2ldnI",
    "title": "Top 10 Real World Wireshark Filters you need to know",
    "channel": "David Bombal",
    "channel_id": "UCP7WmQ_U4GB3K51Od9QvM0w",
    "subscriber_count": 2650000,
    "upload_date": "2023-10-08T14:30:00Z",
    "video_url": "https://www.youtube.com/watch?v=26MAaX2ldnI",
    "category": "People & Blogs",
    "tags": [
        "wireshark",
        "tcp",
        "cybersecurity",
        "malware",
        "threat hunting",
        "filters",
        "display",
        "ip",
        "wireshark filters",
        "wireshark tutorial",
        "wireshark course",
        "wireshark tips",
        "tcp filters",
        "tcp/ip",
        "how to use wireshark",
        "network troubleshooting",
        "packet analysis",
        "packet filtering",
        "free wireshark training",
        "free wireshark tutorial",
        "filtering with wireshark",
        "chris greer",
        "wireshark training",
        "tcp vs udp",
        "wireshark analysis",
        "packet capture",
        "tcp handshake",
        "tcp fundamentals",
        "introduction to wireshark"
    ],
    "views": 114044,
    "likes": 4355,
    "comments_count": 117,
    "description": "Chris Greer shares his top 10 Real World Wireshark filters. Learn how to use Wireshark from one of the best in the industry!  // Chris SOCIAL //  YouTube:  LinkedIn:   X/Twitter:    // David SOCIAL //  Discord:   Twitter:   Instagram:   LinkedIn:   Facebook:   TikTok:    //  YouTube videos MENTIONED // Wireshark Playlist:    Wireshark Tutorial for beginners.  How to Capture Network traffic:    Wireshark Masterclass:    Wireshark Tutorial for Beginners//Where to start Wireshark:    Wireshark Masterclass playlist:    Map IP address locations with Wireshark:    Did you know this malware hack?:    //  Website MENTIONED //   // MENU // 00:00 - Coming Up 00:21 - Intro 01:59 - Filter #1 09:11 - Filter #2 10:55 - Filter #3 17:15 - Filter #4 23:33 - Filter #5 25:48 - Filter #6 31:02 - Filter #7 32:19 - Filter #8 38:55 - Filter #8.5 43:17 - Filter #9 45:40 - Filter #10 48:06 - Chris' YouTube Channel 49:48 - Outro  #wireshark #filters #top10",
    "description_links": [
        "https://www.youtube.com/c/ChrisGreer",
        "https://www.linkedin.com/in/cgreer/",
        "https://twitter.com/packetpioneer",
        "https://discord.com/invite/usKSyzb",
        "https://www.twitter.com/davidbombal",
        "https://www.instagram.com/davidbombal",
        "https://www.linkedin.com/in/davidbombal",
        "https://www.facebook.com/davidbombal.co",
        "http://tiktok.com/@davidbombal",
        "https://www.youtube.com/watch?v=rmFX1V49K8U",
        "https://youtu.be/nWvscuxqais",
        "https://www.youtube.com/watch?v=OU-A2EmVrKQ",
        "https://youtu.be/OU-A2EmVrKQ",
        "https://www.youtube.com/watch?v=OU-A2EmVrKQ",
        "https://youtu.be/IlVppluWTHw",
        "https://youtu.be/slNe6z9gFv0?feature=shared",
        "https://ask.wireshark.org/questions/"
    ],
    "transcript": "I could make this very simple not just on you and your editors and we could put up a list of top 10 filters Bam Bam Bam 1 to 10 right but I want to go through and show you why I use that filter. Well for sure practice is going to be a big thing but there's a few little cheats that I have in here. I always think Chris and it's I mean you've got the experience but how do you learn all this stuff? Hey everyone it's David Bombal back withChris. Chris great to have you back. Good to be back David thanks for having me. So Chris before we actually get into this I just wanted to say congratulations you just got a beautiful silversomething right? I did I just hit 100,000 and I really want to thank you David you really have brought a lot of attention to my channel I really appreciate uh your friendship and collaboration on all of these uh videos we've done. Yeah so huge congratulations for hitting 100,000 subscribers just for everyone who's watching Chris is going to show us his top 10 filters right now but I highly recommend that you go and check Chris's Channel because he goes into a whole bunch of stuff that we not going to cover in this video and on other videos on my channel so he has a masterclass has a whole bunch of other stuff if you really want to get into Wireshark I highly recommend that you go and sub to his channel. Chris you are my favorite person to talk to about Wireshark but you knowwe we often talk about this there's the theory and the real world and you know I can go through all the switches and all the options in Wireshark but I believe you're going to show something real world today like the top 10 filters is it that you use in the real world? Yeah i' I'd like to start there David and one reason is because filtering can be a difficult thing to remember I know coming on board with protocol analysis myself that was definitely something that I hit my head against who wants to sift through a gig trace file one packet at a time but instead looking for specificthings quickly will help us to not just be better troubleshooters, better cyber security analysts but we can do it faster. So let's talk about some filtering. Yeah looking forward to this because like you said it's it's so confusing and um it's like theory versus real world so go for it. Okaygreat so so let's go ahead and do this all right David so this is actually a pcap that we've used in one of our sessions before this is do you remember when we did the malware analysis? Yeah yeah I'll link that below. Okay and the reason why I picked this one to show you some filteringis just because there's a lot of great stuff in here that's going to be fun to poke at with some filters. So first of all let's do this I'm going to just come in here to take a look at these packets and one thing that we have to do a lot of times right off the bat is look for an IP address now let me back up just a moment David I could make this very simple not just on you and your editors and we could put up a list of top 10 filters Bam Bam Bam 1 to 10 right but I want to go through and show you why I use that filter and then how it can be easily remembered. All right so first IP address I mean how often have we had to do that I mean I'm sure you've set one as well right David? Yep. Okay so if I want to filter on a specific IP let's just take packet number one here we have two addresses what if I want to see all traffic coming and going from a specific address all right so this one on the right looks kind of fun 5.1.81.68 okay so I'm going to go and filter on that now the first thing I got to ask myself is I do I want all traffic going to this address or traffic coming from that address or both? Let's just say we want everything going to and from. Okay so todo that I'm just going to come up here I'm going to type in ip. now this is where Wireshark so what I'm telling it is I want this to be an IP filter so using the IP dissector if you will it's going to be one of the IP Fields but which field? Now to do this I'm just going to type in ip addr all right. So first I'm telling Wireshark what field do I want to filter for. Now when I say addr that's going to be either source or destination. If I want to be specific to source or destination one of the other this is where I can say ip.src or ip.dst. now next question would be Chris how do your remember that? Well yep exactly right so if I come up here. Do it a million times like you oh well for sure practice is going to be a big thing but there's a few little cheats that I have in here cuz I just tell you I I don't like typing in Wireshark it's not one of my favorite things to do. So I'm going to come over here going to come down into the bottom left which is my packet output and if I come down here to my IP addressing you see source address, destination address now something that's very cool with Wireshark is that you have a built-in cheat sheet when it comes to the fields. So let's go ahead and have the editor zoom in with me boom down to the lower right you see down here source address ip.source this is going to be pretty small uh but if we're zoomed in on it it's going to look nice and big you can see in the parentheses there there's a field name so when I click on anything in Wireshark anything at all if that field can be filtered for the syntax for identifying that filter is going to be in that little parenthesis so there's a there's your first thing with Wireshark all of this memorization you have to do with the syntax and remembering the dots and the slashes and all the things right there we have a cheat sheet for field name so if I forget ip.source just go to the source address field of IP and then down here on the low right ip.source same with destination ip.destination now if it's either one what I do and this is just me this is what my eyes have gotten used to doing usually it's something that's simple to remember like for example addr right part of the address so that's where something that we can just get used to addr and that will let us do either one. So I'm going to do equals equals I'm going to do 5.1. 81.68 and boom there's my address filter for that single IP. If I take a peek my eyes just automatically it just does it David I'm just walking you through what I'm looking at right now if I come down here to displayed you can see the number of packets that I have is 12953 but of that 12953 uh 683 are displayed. Okay let's let's back up so there's a simple address filter now to me already that was too much typing so now I'm going to show you you can type in a filter or just drag and drop it's a lot easier okay if I come up here to the top I just remove that filter so now what I can do is and this is the real world stuff this is actually what I really do David I don't type in IPs because first of all I I just don't want to I'm lazy say it it's fine um if I come up here to any of these fields if you look at the top up here this whole top like packet list area if you think about it almost like an Excel spreadsheet each one of these little cells has a piece of data in it ina certain category so for example here here's an IP address 5.1.81.68 that is in the destination column so what I can do is I can just take this IP drag I'm literally clicking it right now I just drag it and drop it up top and that's because that was the destination now it automatically will set the filter for me so now all I got to do is go you know what I didn't want destination I wanted everything, so now I have both ways so that's a faster way to set a filter if you could just find it in your pcap drag it upstairs and either fix the filter or fix the destination or Source depending on what you're going for that's a quick way to set a filter for an IP Address. That's great and it's IP because it's not IPv6 right? You'd have to type IPv6 for this is IPv4 right? Exactly yes um now for me here's what I do with v6 just because that can be talk about a lot of typing usually if I'm looking for a v6 thing which I think in this pcap I don't I don't have any IPv6 no I don't David so I can't demo it but what I do is I'll really look for that address what I'll first do is just do ipv6 and then I'll find whatever packets match it and then I can come down and look for the address I'm looking for and that's where I really use my drag and drop because come on who wants to type all that out and one other little cheat that I do is is I'll come up to statistics end points and what this does is it allows me to see all the addresses and from here instead of scrolling and scrolling and looking I can go ooh that's the one I'm interested in I click it right click apply as filter selected so from the statistical view this is where I can also select an address it'll pop me back into the analyzer and it'll give me both directions for that one IP that's also really useful because if I come up here to stats again let's go back to endpoints to see v6 I might have to activate that field here right now mine was deactivated but if I do have v6 I can come over here I can look at all of the entries here in a list and I can right click and I can filter for the one I'm interested in. I always like to ask you the real world stuff because you're doing this all the time and companies send you these pcaps all the time do you see a lot of IPv6 or is it still mainly IPv4? That's a great question and I think the word that I would use isI'm seeing more IPv6 uh I I wouldn't say a lot but it's something that um you know compared compared to 10 years ago it's definitely something that's growing however still seeing a whole lot of v4. But most of your troubleshooting is IPv4 stuff? I would say today it's still mostly v4 yes I'd say that's an accurate statement. All right David let's back up and recap my first filter that I use constantly all the time is an IP address filter let's do another one. I'm just going to modify this just a little bit okay let's just say that this is filter number two even though it's kind of connected to filter number one and that's a subnet filter so the nice thing about an address here I just spelled out the whole thing but if I want to I can just take out as many octets if I want to and I can just pop in a zero and then I can just give it the number of bits in the subnet mask what that'll do is it'll set a subnet filter and it'll allow me to filter for a range of addresses or that are within a specific subnet I can get pretty specific with it I can get into like down to I want to see from this address to this address the first 10 addresses in a certain subnet but often times most of the time practice practically real world a subnet filter will do the trick. So like /24 /16 or something right? 100% yeah usually that's that's what I'm doing. That's great so all you did was change the octet from whatever valued was to like zero the last octet and then make it /24? You got it. That's great. Now for everybody out there that doesn't want to remember what I just said what we're going to do is we're going to come over here to this little plus button you see that little plus button there let's click that and what we're going to do is just call it subnet filter subnet filter okay and although you will probably change the IPs as you grow in your analysis I'm just going to say okay and now I have on the top right over here I've got this subnet filter button so now when I come back to Wireshark next time if I just want to set a subnet filter I can just click that and then I can change the variables change the addresses and I don't have to remember how to set that so that's saving filter buttons that's another little mini tip that I'll give you. So let's recap David we first did a specific address and and then we learned how to filter for a subnet. Now another very common one that I get asked about or one that I set myself is for a port number be it UDP, TCP or a range so I'm going to show you there's two aspects of this next filter that I'm going to show you one is a specific port and the next is one of ports on a list whether the port is this or this or this or this go ahead and display it let me back up going to just remove this and I'm going to show you the Y Factor so a lot of times I'm doing TCP analysis that's the Y uh and ports are a big deal so just like it sounds tcp.port== got my double equals and this is where the this operator makes a difference so before I dig any deeper into these weeds first I just want to talk for a moment about these operators that you see here so there's several different operators that I can use one is the equals here so if I'm saying hey this field compare it to this value well and then show if true then I use equals equals I also could use the English expression of eq it does exactly the same thing all right both will turn Wireshark green when you get your filter syntax right you see the Wireshark filter turns green when it's wrong or when it's got something missing it'll warn you by giving you that red display filter bar. Okay so tcp.port eq is the same as equals equals what else can we use here we can also use uh is not equal to so show me all the stuff that's not Port 80 uh what else what else uh there's a few other operators like for example I could say I can also use maybe an or or an and operator when I'm looking at different values I'm going to progressively be showing you how to use those but for now let's just do equals equals and I'm going to go ahead and type in 80 show me all the port 80 traffic. Well as you and I know Port 80 is kind of disappearing from a lot of things now a lot of things are going over secure web they're going to go over to Port 443 so let's say that I wanted to see either Port 80 or 443 well I could say Port 80 or back out 443 sure but how could I see one or the other well there's a couple ways I can do that one I could say tcp.port == 80 or tcp.port == 443 right? Now as we know some uh web servers use more than Port just Port 80 they might use or even uh secure web servers they might do 443 or 8000 8001 8002 so I could just make a big list of or how do you like that David does that look efficient? Uh not if I know you Chris. Yeah I can just you know completely burn myself out putting in all the port numbers or what I can do let me just back this up anytime that I'm using the same field name right over and over again port port port what I can do now is I'm going to show you the next coolest filter ever in the the world. Okay so TCP port and I just I just used in the in operator. Hey David has you ever heard of the in operator before? Uh no tell us about it Chris. Let's do it so this is the membership operator and what this does it allows me to use a curly brace and then I can give a bunch of different values here that can be used as basically or statements in a way so TCP port in membership operator I think about it like includes or could include 80 comma you got to be comma separated 80,443,8000 and then here's a cool thing dot dot makes it a range 8005 curly brace that's nice so what I just specified is show me any packet that has a port that is 80,443,8000...1,2,3,4,5 and I did that all with one expression. I always think Chris and it's I mean you've got the experience but how do you learn all this stuff just like check the reference guides watch your videos on your YouTube channel how do I learn this stuff? You know what that's a very good question David and that's where I want to give some props to some other analysts in the in the industry there's a a friend of mine named Jasper and Sake there's these two amazing um people in the Wireshark Community you can find them in fact Sake if you go to Wireshark about you'll find his name in the authors right Sake so these these guys uh they're friends of mine they're amazing analysts and by observing some of their workflows what I've done is I've gone whoa I'm doing this wrong I could do this better so a lot of times going to an industry conference like sharkfest or and having conversations with these ones through various means um that's where I can say hey I need to set a certain type of filter. David you asked how I learned some of these things I just mentioned some of the industry experts but here there's another area that I'd like to take a look uh and this is ask.wireshark.org you can get here if you just go to the wireshark.org homepage and then at the top I believe you just go to uh ask a question and it'll bring you here or if you could just bookmark ask.wireshark.org uh this is where people when they got questions about Wireshark packet analysis how to set a filter all the stuff this is just a monster Wiki and the awesome thing about it is that some of the people that are answering these questions like Jaap he's a core developer this this is one of the developers that is actually writing this thing you know. If you look at some of the others Christian_R, if you look at Chuckc he's this awesome guy I mean SYN-bit that's that's the one that I just showed you Sake so these people are actively answering questions out on ask.wireshark.org fantastic community and if you have a question that or maybe a protocol or a filter you'd like to set not sure how to do it you can either search for it see if it's been covered or go ahead and register and ask it and you're probably going to get help from one of the core developers great question David and thanks for asking it. Okay so where were we? We already set an IP address we did source and destination I showed you how to look at those filter names we went and save the filter and we went ahead and looked at how we can set a range of ports using the membership operator. So I think that's three filters is that right David? yep yep. So another one that I'm going to set this is the fourth display filter that I use I would say this one's just as common as the rest and that is a TCP conversation filter so not just a port number I want to see the actual conversation between these two endpoints using this port now to manually set that I would have to say IPAddr IP and IP Addr IP so I would set the IP address to those two IPs and it would give me the conversation between those two addresses and then I also would need to include the port numbers so TCP Port equals equals XYZ and TCP Port equals XYZ it's really manual though right so one way that I do this I'm just going to give you the real deep di practical if I come up here to statistics going to go to conversations and I'm going to bring up TCP basically one thing that I like to do is I like to look for a conversation that I'm digging for so maybe if I just I'm just going to sort on Port B I know in this pcap there's an interesting conversation like here on Port 447 that's only because I've seen this pcap several times that's going to catch my eye if I right click on that guy right click apply as filter selected and I'm just going to drop down here to filter A B B to A and I'll show you why in just a moment so I just set a filter there I hit I clicked it close and if I come up here you can see all the parameters that are needed to set a conversation filter right so like I said it's got to be IP Addr address A and TCP Port Port A and IP Addr address B and TCP Port B right so all of those things need to exist in order for a packet to be displayed and I said source or destination so it could be add or in either direction now that's one way that I do that. Let me show you another something that I see a lot of people do I'm just going to jump back up to the top is when I want to filter on a conversation what they'll do is they'll right click it and they'll go follow TCP stream and yeah a lot of people do that. Yeah and you know what there's there's nothing wrong with this but watch what I do. Okay I'm looking around London sounds dodgy um thanks Chris you're welcome just had to throw that in you know if I I'm looking here but but this is encrypted so likely the next thing I'm going to do David is come over here and hit close so now I've filtered on a stream but I'm not filtering on the conversation per se well I I am it is the conversation but the first thing I did is I ripped out the stream data that is encrypted and put it on a screen that I'm going to close. Okay so let's look at a better way to do that if I right click packet one conversation filter TCP this is the better way to do it so now I'm not going to go and have that stream data that I just close if I'm filtering on the TCP conversation then I can come right here and you notice here I think I thought this was interesting when I first saw it um you notice that the conversation the TCP conversation syntax is a little different here than it was a minute ago when I came from statistics that's because different people wrote those different things that's interesting so there's nothing wrong with either one they both accomplish the same thing. Here I've got a parentheses around the two IPs and a parentheses around the two port numbers I just as easily could have said address and TCP port and address and TCP Port like it came over before so you'll see this as you continue to use Wireshark there's not just one singular way to do something sometimes there's more than one way and your way is the best way it's the one that makes the most sense to you with the logic of the filter. Called the tomato right yeah and aluminium. Yeah exactly that's a good example. Come on you you've got to say it the way you say it. You mean aluminum? That's right yeah that's right yeah. And it's tomato? Yes Chris. Let's practice David because you're the Wireshark Guru I'm going to agree with you correct. Let's okay we're going to practice everyone let's all say it with David tomato. Tomato. Yeah okay we'll go with that. Okay so same packets. Sorry for the sidetrack but yeah it's it's a it's the same result I always I always laugh when people get upset about stuff like that because it's you know do it the way like I love the way you said it do it the way that works for you. Yeah exactly and well because this comes from and I'd like to share this with you in the audience is because this comes from being asked in front of a lot of people and a lot of different audiences and and experiences being in with in classroom settings. Hey Chris what is the right way yeah exactly and I say well what is this is a way and now if you find a better way for you use it. You might think that my way is the craziest way inthe universe and it makes no sense to you. I've been told worse in my life and you know as long as we're getting to the right packets that's all that matters. Okay so next filter five one that I use quite quite a bit is when I'm analyzing something and I want to see more than one protocol so this is a simple one let's just say that I want to see all TCP as well as all DNS cuz a system might be sending out a DNS request and then establishing a TCP connection and I want to see both of those protocols. So that's a simpler one tcp or dns both of those. Glad you're doing that I'm glad youdidn't do TCP or UDP because it's different layers right so that's good to see. Exactly yeah I'm notjust talking any UDP I specifically want to see DNS now um with that said you know sometimespeople go I want to see TCP and DNS now unless DNS is running over TCP which it can but manycases we use DNS over UDP uh that's why this is going to have any results because I was too specific with my filter and there aren't any packets that are both TCP and DNS that's what I'm saying the logic that I work through here is to display a packet it has to match TCP and DNS display. So that's why the filter doesn't net anything for me so in this case or is the better operator. Okay so that was filter number five. But I love what you're doing Chris because you know like we said and I don't want to reiterate too much but it's what I love about these interviews with you is you do this stuff all the time in real world troubleshooting, analysis, you know finding dodgy traffic and you distilling the stuff that you actually use day to day. Yeah absolutely this is not just some list I read off a book exactly in fact I found these lists in some book so I kind of wonder if people are listening which is great hey use it that's fine that's fine okay um. Next is when I'm looking for a word I mean sometimes I'm just looking for a string in a packet I know a lot of things are are encrypted right like they're running over TLS over over TCP so they're encrypted however sometimes you still get a word or two in there like for example the one that we just saw London so if I want to go hunting for a word this is another common one now this is where I first specify where or what protocol do I want Wireshark to begin looking at. Right so I could just say IP or I could say TCP or I could say UDP or I could say DNS or I could say HTTP right so what protocol do I want to start with? I'm going to begin with you know IP now that's IPv4 when I don't specify that so I'm say IP and now one I'm looking for a string typically I'm either using contains and then I spell out the string or let's see if that matched anything it sure did or what I can do if I you see how London is capital up here yeah so right now I've got 26 packets that match so instead I can use the the regular expression operator and that's matches and what that does is it allows London to be any case that just made it case insensitive okay so this is a common that I use by habit what I'll do is instead of IP TCP or otherwise I just do ethmatches so now anything that is basically in this pcap anything that's encapsulated or wrapped in Ethernet I don't care if it's TCP, UDP, HTTP pick it or in this case TLS the reason why this is showing is because a lot of times the server identifier is going to be clear text so that's where we'll see or the certificate sometimes you'll see some info in there uh but at least that's where I'll I'll find that word uh that I might be looking for. And like most traffic if not all traffic you see today is Ethernet right all that old dodgy stuff is long gone. Almost all I mean I don't often see non- ethernet sometimes in Wi-Fi environments that's kind of another conversation but uh usually most the time you're getting ethernet too. Chris question I think we've discussed this previously is like how do I get rid of stuff that I don't want to see cuz you know there's so much stuff out there on the network and it's like trying to find a needle in a hay stack type thing. Yeah so how do I kind of get rid of things but leave the rest yes oh that's a great question David one that I use practically a lot and let's go that and get that into the next filter which I'm sorry everyone if I'm wrong on this I could be but I think we're on six I believe so if I'm wrong hey hit me up in the comments and tell me that I don't know how to count I'm fine with that or you just got 11 out of me I'm fine with that too. Okay uh so let's come up so I call this the like get rid of background chatter uh filter yeah and what this means is that sometimes there's filters or there's protocols or conversations that just make it staticy and murky and they get in your way all right like for example if you just sent me a full PE cap off of a network a lot of times there's broadcasts running around there's ARPs running around there's STP running around layer 2 stuff uh so CDP LLDP not that that stuff is never useful of course there's times when ARP is useful of course there's times when STP is spanning tree no question however sometimes it just gets in my way so this is what I do I like to do a not open parentheses and this is where I can say get rid of the ARPs or uh thisis where I can say STP or LLDP or CDP or eth.addr == ff FF cuz I got to use a MAC address here that's a broadcast so let me be very specific again it's not that I'm saying those things are never useful of course they are but sometimes they get in my way so I just scrape all those out and from here I can just keep going what if I say or tcp.port in squiggly and if I do uh443 for example just because I'm looking at this conversation let's just say let's just get rid of all that stuff and then just a close paren okay so I just got rid of that conversation let me come over here I'm just going to say I'm just going to start scraping away things DNS or TCP port and 443 I'm going to do a comma 80 because that's just the next thing I physically see now check that out right away you see by scraping stuff off the weird can rise to the top so especially when you're threat hunting this is the type of thing that's super useful get rid of what you know even though it's possible they can be hiding in plain sight using um 443 to run command control traffic that's absolutely 100% possible but if I'm ever looking for weird protocols that I shouldn't see this is a way to get rid of the ones that I I know that I typically do see so here's a 447 how do you like that one David? Yeah Chris that's fantastic would you ever like scrape out all this stuff and then save that pcap as a new pcap and then take that pcap that's been filtered and then search for specific things or would you like in that same filter remove stuff and then look for other things? Yes I would so especially if you sent me a lot of times I'm working with clients and they send me very large pcaps so one of the first things I want to do is reduce them so what I'll do is I'll throw a filter like this at it get rid of the stuff I don't want to see and then save whatever's left over now to do that don't go file save as that's not going to work all you're doing is saving this file again maybe as another name but all the same packets what you got to do export specified okay so if I come down here let's go aad and focus down here in the bottom this is this is where I can give it a file name David and then I can come down here and say give me all packets that are displayed or I can say all packets within a range show me the displayed ones but only show me 100 to 1000 that's only going to save 901 packets all right so that's something I do that'll scrape out what I see or the ones that I select into a new pcap and then I close this one open up the new one and now I have a much smaller data set to work through. What's the biggest pcap you've ever received in size of like how many gigs? I got a 30 gig before goodness I think that was the largest one yeah and I had to use yeah I mean. That's insane. Right yeah I had to use command line tools to chop it up first because if you try to open up something like that in Wireshark either it'll choke or it'll take a very very very very very long time Wireshark's not designed to handle packet captures efficiently at that size one reason is because it's doing so many analytics under the hood for all of these packet captures or for all these packets. I mean 30gigs of text is insane. Oh come on yeah no one wants that so a lot of times for that David I'll I'll go to the command line tools which hey you know what maybe coming to a future Bombal video near you is we'll we'll show how to slice and dice large pcaps with a t-shark. I'm glad you show you're showing this because it's like okay it's great to have this filter where you've got the noise but the real world implementation of that is you manage to get this crazy large file all the large files that people send you and you get it to the core stuff that you're looking for. And honestly David it also comes down to the way it's captured from the get go what I try to do with my clients is capture so that you fill up a pcap and you stop and start the next one so you don't ever get to super large pcaps you're capturing so that they never cap out more than a gig right okay so that. I was going to ask you what's a good size? so a gig's good size? Yeah I mean a gig or less is what I I shoot for so maybe we can either in the comments down below or uh link up above there's a video that I have on my YouTube channel about how to set that up so that' be great and it's how to capture in smaller chunks just to make the work easier for you on the analysis end. I'lllink that below that's brilliant okay filter 7 we ready? I think we're there yeah I think it's sevennow. Another one that I use a lot is going to be and this is number seven wait I just showed you six seven all right uh let's go to tcp.analysis.flags there's a one that I use and the reason is that so basically Wireshark one of the things that it does and one of the reasons why it takes a long time to open up pcap that's super huge is it's doing analytics and looking for stuff in pcaps one thing is for TCP Flags so anytime you have TCP act unseen segment, retransmissions, fast retransmission, spurious retransmission, out of order, zero window, anything that is TCP interestingness even if it's not necessarily broken but maybe something that should merit attention uh this is uh a filter that I use. In fact to be very honest what I'll do is a lot of times window update unless I'm doing throughput analysis those are things that I can disregard I'm not super worried about them so what I might do is just say tcp.analysis.flags show me that and not and if I'm totally going to forget the syntax I'm going to show you how I get it I I do not want to show window updates so let me go ahead and expand TCP and I'm going to come down to you see where it's at the blue down here sequence acknowledgement analysis it's showing me hey Chris there's stuff here Wireshark found some interesting things in fact span this out it's just showing me that hey this is just a window update I can take a look down below and I can see what the syntax is tcp.analysis.window_update way too much to cap to type out so if I just drag this upstairs and I say uh I'm going to unclick and now it's going to ask me a question hey Chris do you want to replace what you have with this or do you want to append this to what you have? So this is where I'm going to say and not now it's going to fuss at me at start cuz I I got a double knot in there and and oh oops I took out the wrong knot and knot window update hang on oh okay I got to fix this a little bit because I already did some of the work for me so I have to take out the and knot cuz it basically did a double and knot so sorry everybody if you just did TCP do analysis. flags and then you drug this up and said and not that's to be the easiest way so now show me all the flags but do not show me the window updates now just show me the brokens black lines with red letters the retransmissions the bad things the reason why these are going to catch my attention is because I don't want to see a whole lot of retransmissions if I can help it I don't want to see a lot of out of orders and dup backs and troubleshooting Network layer issues so a lot of times when I see these kinds of events that's telling me that I'm getting packet loss somewhere in this pcap I don't see a lot of them I only see what a whopping five packets that met that filter I'm not going to worry too much about it but imagine David what if I saw thousand of these yeah that's where I'm going to go hm between what two systems do I see lot of retransmissions hm that's between me and my server hm that application's slow maybe the Network's dropping traffic. All right are you ready for eight? Yeah that'd be great all right so there's other really interesting filters or or fields I should say that Wireshark does for us let me jump to the top again all right and these are called time filters. Now there's this is automatically done by default with Wireshark we just got to know where to look so an easy one to demonstrate this with I'm going to do it with two things one is a TCP time filter and the other is DNS let's actually start with DNS because that's the easier one so I'm just going to have everybody just filter on DNS bam now this is all the DNS requests and replies in the pcap. Now automatically Wireshark if I click on that first packet you see over here on the left of the screen I've got two little arrows this indicates what is the request and what is the reply now if I click the reply and if I come down here digging if I go down down into DNS and if I come down to below answers I can see time now if I click on this notice down below it says DNS.time so Wireshark automatically measures the amount of time between a DNS request and a response so all I got to do is let's just do this I'm just going to right I'm actually going to drag and drop okay I'm going to apply that as a selected filter so dns.time == then I've got the actual value for this specific call but let's do this what if I back up instead of dns.time == what if I do dns.time > 0.46 048 so let's just do dns.time > 0.10 so what this does is it shows me show me all packets with DNS time that is greater than 10 milliseconds. That's nice in other words you're looking for slow DNS responses right? That is correct. That's nice. So right here what I did is I just right clicked it I kind of did this while you were talking David I right clicked apply as column for dns.time and then I can come up here and you notice now that I've got a Time column this measures DNS response time and I can sort I can sort that so now I know the slowest DNS response that I had in this entire pcap was 257 milliseconds. So now 10 seconds is pretty quick so let's actually make this a little bit better I'm just going to dot two, so 2 milliseconds so now show me any responses that are slower than two I'm sorry not 2 mil, 200 milliseconds and this is something that you bet we can add I'm going to hit plus I'm going to say slow DNS and I'm going to say okay and now I've got another button over here slow DNS and I can change that value do I do I want it to be half a second or I want to be a full second so now as I'm going through pcaps now I can just start looking for slow DNS time now this is fuel for another conversation David this is also a value that we can graph out so we can see how DNS is performing over time from right within Wireshark we'll do that another time though. How often is DNS the problem Chris in your experience is this saying that it's always DNS right? I know I know the saying is it's always DNS but I hear you know I'm usually the defender of many different silos right it's always the network, it's always DNS, it's always the firewall, it's always the, so I'm usually the defender of the always the guy or girl uh so DNS can be a component yeah is that an answer? Basically you're saying it's not something that's it's not always the problem it's many other things as well absolutely I mean it can be something else but I will say this you're you're in trouble if DNS is the problem like that's usually and symptomatically what I'll listen for is it's slow to connect to an application and not just one application multiple applications uh things are laggy and weird uh DNS health is something I definitely want to check for first like take for example this slow DNS let's just take this as an example David if I come here to slow DNS and I get no Hits onDNS that time, it's greater that milliseconds now I know DNS is fine from a performance perspective and now I might want to do some errors go looking for some DNS error level things or what I also could do is just say name I can start to take a look if I apply this as a column start looking through the names that are coming back as responses and see if I have any strangeness there as well. You said earlier if you have a DNS problem that's uh that's an indication that there's some other major problem right? If DNS is broken then we have a problem so that's why DNS Health that'll be something that I validate usually right off the jump and my eyes do it quickly David I mean let me show you what in real world real talk this is what I do if I just remove my filter because we were already into the weeds a little bit let me jump back up to the top so right here what I do is I I look through and I go hm my eyes my eyes my eyes ooh DNS ooh response 48 milliseconds okay that's not why you called me unless that response is wrong or busted in some way but usually if it's performance things worked but just not quickly usually my eyes will go 48 Mills that's not why David called me for this little 48 milliseconds let's go hunting for why he called me. Now time we're still on time okay so let's go on to the next filter that this is not filter number 9 this is actually 8.5 so this is a bonus filter so I talked to you about there's different time filters one of the thing that I I like to show you is a handshake filter or a TCP time filter is one of them. So if I come up here to packet number one you see packet number two is coming back and you see my Delta time is 134 milliseconds now we in previous videos maybe we can link below uh we talked about how to set up the Delta time or if you want to see another video about it I got one on my YouTube channel the Wireshark Master Class lesson one so if you stop into my channel you'll find it there so go check it out it's how to set this up how to some of the coloring rules that you see how my TCPs are green I'vegot a Delta time filter here you see all these buttons and all these different profiles how to do all of that just go check out that video and uh you can see some of the setup so for purposes of time I I'll just leave this here so syn and syn-ack comes back 134 milliseconds this is now a a a measurement that I can take a look at in Wireshark what Wireshark does is it adds up the Delta time between the syn and syn-ack and then the final syn-ack and a the three packets of the three-way handshake this gets added together so 134995 this is now something that Wireshark calls IRTT Initial Round Trip Time. So let's go hunt for that number now it's going to be down in TCP and this is sequence acknowledgement analysis and you see IRTT here same value and we can see where it comes from it's the Delta between the syn syn-ack and the syn-ack in the first act. So now IRTT so now this is something I'm just going to right click for a moment and add it as a column and I'm going to remove this Delta time or this DNS one and if you notice that same value is used for all packets that are a part of that conversation because there's only one IRTT per TCP conversation so it's not a super useful IRTT thing if I'm just glancing through one conversation but as soon as conversations start to fly then what I can do is I can sort this and if I just go up oh that's going I'm just going to jump down to the bottom now so the most time that I have the largest IRTT these are one-offs down here I'll talk about those in a minute but the largest IRTT that I have is 616milliseconds between two end points that was in the handshake so let's actually investigate that right click conversation filter TCP and then I'm going to click number to put my packets back in order so right here David what we just found is look at that a 616 millisecond network round trip time between these two end points does that sound good? Only if you like maybe right exactly that doesn't make me too happy so I've got some delay here now um if I take a look just so you know on this profile I also have something called GeoIP enabled so if I come up to IP I can see that this uh Source IP address is Indonesia so if my client is let's just say in the UK and this server is in Indonesia well then you know okay I'm going quite a distance between these two endpoints or maybe I'm not properly connecting to the server that I should be that is more local to me in my environment or maybe my CDN isn't sending me to the right place. Yeah I mean in other words I mean the thing you've highlighted that but it could be like that they're not using Cloud flare or CDN like you mentioned or I mean that could be normal right in certain parts of the world? Could be or as you know this uh pcap is named Malware analysis so this client is actually initiating a connection to somewhere over in Indonesia and it shouldn't be. Okay so that that's something that might be interesting that leads us to filter number 9 but before I get to filter number 9 the next question for users is wait my Wireshark doesn't have destination GeoIP how do I get all that Chris how can I see City Country and then even uh latitude longitude well we're going to link another video down below because I actually have how to find IP addresses Geographic and map them and uh we did that together David but maybe a shorter way to do it to give everybody just a link um they'll also meet my cat he walks across the table in that video so nice very yeah got to meet Pepe yeah so you can go ahead and um link that below but that's just a five minute quick how to set that up in Wireshark okay David that actually brings me to my next filter that I have for you and that's when I'm filtering on a country code so you just notice that I have my GeoIP filtering here so something that I might do is come down here like Source or destination GeoIP Two Letter Country Code and is this one's Germany for example that's the country code so if I take this I'm just going to drag it upstairs and this is where I can say show me anything to and from that country code. Now can that be spoofed yes do I absolutely know that this is coming from Germany? No, however does it give me just a ballpark possible uh that looks a little weird type of thing absolutely absolutely or maybe I want to come up here and I just want to say something like UK I think in this you know let's pick on those UK guys and let's just say I do not want to see anything coming to and from UK show me show me everything else so if I have a system that should be contained within you know IPs that I know should be coming from my environment or from thereabouts show me everything that is not so that can be an interesting filter that of course requires the GeoIP databases but once we have those there uh we can use those to our advantage especially when threat hunting. And in the real world that's helped you eh? Oh absolutely yeah in fact I have a profile one of my profiles is my security profile and if I bring that one up my security profile and one of the things that I have is countries and then just some of the country codes that I look for that typically might raise a flag when I'm threat hunting. Thing is Chris you know in there's a theoretical part of it that we can debate and then there's what you actually do on the ground and that's what's you know it's nice to ask you those questions and you just give us your experience I mean experience varies but it's great to hear what you do. For sure well and you can see right here you notice that even some of my coloring codes when I switched over to this profile which again you can learn from lesson one of my Wireshark master class go check it out but basically what this does is it makes those things jump out a little different you notice that this client hello is now red or uh now the response this DNS response is now orange so here I can see that I've added some things like this one is if you open up the frame information DNS count.answers are greater than five hm so I've got a DNS reply that's larger than five responses which might look a little sketchy that's a little sus as they say so might want to go digging into that and make sure that's okay all right so that was number nine. All right David we've come to the end the last number 10 most used Wireshark filter packet head certified any idea what it's about? um No tell us. Okay good. One that I do a lot is istcpf.flags.reset ==1 that the reset field is set, now reset this is an abortive release this is when one side or the other of a TCP connection says bye talk to the hand I'm done so if this happens after a conversation has finished no big deal well that could be just how the system is shutting down the connection might not be pretty but you got to hang up the phone eventually anyways but the problem is what if this happens at the beginning of a connection or what if during Midstream I ask you for something David you start sending it to me and then boom I just send you a reset out of nowhere or you send me a reset in the middle out of nowhere that's also suspect little sus so uh resets are something that I find myself analyzing especially when we have disconnections applications that suddenly disappear or maybe never established in the firstplace, maybe we're sending syn and getting resets back uh somewhere else I'll look for resets is if I have a large number of them and it could be that we're those are coming from ports that are closed so say for example I'm just going to pick on an IoT device what if I see an IoT device kicking off a ton of resets but it's also getting a bunch of syn activity to Ports it's not supporting so that's weird like who's talking to it why are is it getting scanned do I see an NMAP signature do I I mean NMAP is going to generate a bunch of resets that's because it's sending syns and resets are coming back so where are they coming back from and why are they there so this is I would say pretty safely that this belongs on the top 10 list of Wireshark filters that I use most often. This is brilliant Chris I mean like we were you said earlier something you know people can read a book and some books actually use your list it sounds like but this is real world stuff right? Yeah for sure and I and I can't say that definitively but yeah I've seen some similar lists out there but you know what though these are the common filters right these are ones that I use and I think my intent here was to show people not just what they are but why I use them and how they can use these same tricks like for example how the filter is actually defined there on the lower left of the analyzer and also dragging and dropping and and adding filters together some of these tricks to build your own filters and not get too wound up in the syntax. Chris the big question is this is fantastic but where can I learn more and I know you've got an amazing YouTube channel so perhaps you can take us to your YouTube channel and tell us where we can start like is there a playlist that you you've mentioned one or two I think you know if I want to learn more which playlist should I start with on your channel and you know take us down that road. Thanks David for sure and invite everybody to check out my YouTube channel so let's go ahead and uh take a peek uh here itis so just either search Chris Greer, search Wireshark, search I just did Greer Chris just because I'm signed out here on this browser uh Wireshark TCP uh there's hopefully a lot of ways and we canlink it below uh but here you can see this is what it's about so about making Wireshark more digestible and easier to use cuz look I don't forget how daunting it was I remember. yeah So one of the things that I've done is is put together uh basically it's a TCP not just TCP but it's a Wireshark master class so if you come down here this playlist Wireshark masterclass it takes you through nine lessons of the most common things that you need in order to be effective with Wireshark. If you're studying for a cyber security cert, if you're looking for joining a CTF and there's going to be some common stuff most of what you're going to need is in that Master Class apart from that you can see oh there's this guy here this guy that I've talked to before um Spyware Analysis, Malware Analysis tips about TCP, How TCP actually works uh some of the strange things that you see within Wireshark itself MTU versus MSS lots of different uh Hands-On stuff and I will say that a lot of my videos I give you the pcap so you can follow along and you can actually do something while I'm walking you through it. That's brilliant just for everyone who's watching please go and sub to Chris's Channel please go and show the love Chris is sharing his years and years of knowledge with all of us and making it freely available so please go and show your love and subscribe to hischannel Chris as always really want to thank you for sharing and um look forward to our next one. Thanks for having me back David I hope that soon.",
    "transcript_keywords": [
        "filter",
        "TCP port",
        "TCP",
        "TCP time filter",
        "DNS",
        "Wireshark",
        "David",
        "TCP Port Port",
        "conversation filter TCP",
        "port",
        "TCP Port equals",
        "Chris",
        "port port port",
        "Wireshark filter packet",
        "time",
        "filters Bam Bam",
        "TCP conversation filter",
        "Yeah",
        "show",
        "things"
    ],
    "transcript_entity_values": [
        "a ton",
        "Wireshark masterclass",
        "5.1",
        "three",
        "TLS",
        "9",
        "1,2,3,4,5",
        "London",
        "80",
        "two",
        "MTU",
        "Time",
        "eight",
        "only one",
        "TCP",
        "thereabouts",
        "second",
        "Pepe",
        "YouTube",
        "larger than five",
        "Wiki",
        "2 milliseconds",
        "Okaygreat",
        "English",
        "HTTP",
        "0.46 048",
        "NMAP",
        "FF",
        "XYZ",
        "David Bombal",
        "Indonesia",
        "CDP",
        "LLDP",
        "Ports",
        "8.5",
        "Port 80",
        "more than one",
        "Wireshark",
        "Port 443",
        "10 seconds",
        "30",
        "2 mil",
        "today",
        "100 to 1000",
        "Chris",
        "CTF",
        "one",
        "IRTT",
        "11",
        "Chuckc",
        "TCP",
        "DNS",
        "Port 447",
        "257 milliseconds",
        "DNS Health",
        "616",
        "first",
        "UK",
        "Bam Bam Bam 1 to",
        "STP",
        "IP Addr IP",
        "six seven",
        "IoT",
        "Port",
        "12953",
        "683",
        "number five",
        "901",
        "443",
        "Wi-Fi",
        "200 milliseconds",
        "Greer Chris",
        "dns",
        "years",
        "nine",
        "David",
        "48 milliseconds",
        "IP",
        "8005",
        "26",
        "48",
        "MAC",
        "thousand",
        "syn syn-ack",
        "Jasper and",
        "447",
        "Delta",
        "1",
        "Bombal",
        "number two",
        "10",
        "Mills",
        "a minute",
        "six",
        "Germany",
        "IPAddr IP",
        "5.1.81.68",
        "seven",
        "ARP",
        "five",
        "10 years ago",
        "five minute",
        "Wireshark",
        "2",
        "zero",
        "UDP",
        "Network",
        "100,000",
        "Excel",
        "nine lessons",
        "134995",
        "100%",
        "number one",
        "616milliseconds",
        "CDN",
        "greater than five",
        "81.68",
        "0.10",
        "134 milliseconds",
        "the Wireshark Community",
        "Two",
        "syn-ack",
        "Wireshark",
        "Jaap",
        "fourth",
        "Chris Greer",
        "7"
    ],
    "transcript_entity_types": [
        "QUANTITY",
        "PERSON",
        "CARDINAL",
        "CARDINAL",
        "ORG",
        "CARDINAL",
        "CARDINAL",
        "GPE",
        "CARDINAL",
        "CARDINAL",
        "ORG",
        "ORG",
        "CARDINAL",
        "CARDINAL",
        "NORP",
        "TIME",
        "ORDINAL",
        "PERSON",
        "ORG",
        "CARDINAL",
        "PERSON",
        "QUANTITY",
        "PERSON",
        "LANGUAGE",
        "ORG",
        "CARDINAL",
        "ORG",
        "PERSON",
        "ORG",
        "PERSON",
        "GPE",
        "ORG",
        "ORG",
        "ORG",
        "CARDINAL",
        "FAC",
        "CARDINAL",
        "PERSON",
        "FAC",
        "TIME",
        "CARDINAL",
        "CARDINAL",
        "DATE",
        "CARDINAL",
        "PERSON",
        "PRODUCT",
        "CARDINAL",
        "ORG",
        "CARDINAL",
        "PERSON",
        "ORG",
        "ORG",
        "FAC",
        "QUANTITY",
        "ORG",
        "CARDINAL",
        "ORDINAL",
        "GPE",
        "PERSON",
        "ORG",
        "ORG",
        "CARDINAL",
        "ORG",
        "FAC",
        "CARDINAL",
        "CARDINAL",
        "CARDINAL",
        "CARDINAL",
        "CARDINAL",
        "LOC",
        "QUANTITY",
        "PERSON",
        "ORG",
        "DATE",
        "CARDINAL",
        "PERSON",
        "QUANTITY",
        "ORG",
        "CARDINAL",
        "CARDINAL",
        "CARDINAL",
        "ORG",
        "CARDINAL",
        "PERSON",
        "PERSON",
        "CARDINAL",
        "LOC",
        "CARDINAL",
        "PERSON",
        "CARDINAL",
        "CARDINAL",
        "ORG",
        "TIME",
        "CARDINAL",
        "GPE",
        "PRODUCT",
        "CARDINAL",
        "CARDINAL",
        "ORG",
        "CARDINAL",
        "DATE",
        "TIME",
        "PRODUCT",
        "CARDINAL",
        "CARDINAL",
        "ORG",
        "ORG",
        "CARDINAL",
        "PRODUCT",
        "QUANTITY",
        "CARDINAL",
        "PERCENT",
        "CARDINAL",
        "PRODUCT",
        "ORG",
        "CARDINAL",
        "CARDINAL",
        "CARDINAL",
        "QUANTITY",
        "ORG",
        "CARDINAL",
        "PERSON",
        "ORG",
        "PERSON",
        "ORDINAL",
        "PERSON",
        "CARDINAL"
    ]
}