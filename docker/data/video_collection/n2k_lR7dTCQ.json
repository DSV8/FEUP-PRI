{
    "id": "n2k_lR7dTCQ",
    "title": "Hack a network and capture passwords using Python and Kali Linux // FREE CCNA 200-301 Course",
    "channel": "David Bombal",
    "channel_id": "UCP7WmQ_U4GB3K51Od9QvM0w",
    "subscriber_count": 2650000,
    "upload_date": "2024-09-27T14:00:47Z",
    "video_url": "https://www.youtube.com/watch?v=n2k_lR7dTCQ",
    "category": "Science & Technology",
    "tags": [
        "dhcp",
        "mitm",
        "kali linux",
        "python",
        "dhcp attack",
        "dhcp exhaustion",
        "rogue dhcp",
        "ccna",
        "free ccna",
        "dhcp hack",
        "dhcp server",
        "kali linux tutorial",
        "ccna 200-301",
        "linux tutorial",
        "hacking",
        "cisco training",
        "ccna study",
        "kali",
        "linux",
        "kali linux hack",
        "ccna course",
        "ccna free course",
        "free ccna course",
        "ccna v1.1",
        "ccna 2024",
        "cisco ccna",
        "ccna training",
        "packet tracer",
        "ccna full course",
        "ccna exam",
        "ccna 200-301 full course",
        "free cisco",
        "switch",
        "200-301",
        "scapy",
        "python hacking",
        "kali linux python",
        "hack",
        "router"
    ],
    "views": 43230,
    "likes": 1742,
    "comments_count": 74,
    "description": "Big thanks to Brilliant for sponsoring this video!  To try everything Brilliant has to offer for free for a full 30 days and 20% discount visit:   Did you know that DHCP can be hacked? In this video I demonstrate multiple DHCP attacks which show why you need to enable DHCP Snooping on untrusted ports in your network. Only trust ports with legitimate DHCP servers and don't allow attackers to host rogue DHCP servers in your network.  // CCNA Complete Practical Course // Expect regular updates - the full course will be uploaded on my Tech Channel here:   // Python Script used in this video // DHCP Exhaustion:   // David's SOCIAL //  Discord:   X:   Instagram:   LinkedIn:   Facebook:   TikTok:   YouTube:   // MY STUFF //     // SPONSORS //  Interested in sponsoring my videos? Reach out to my team here: sponsors@davidbombal.com  // MENU // 0:00 - Intro 00:48 - Ad: Brilliant 03:00 - Understanding the Topology 04:14 - DHCP Snooping 06:31 - Demonstration 11:39 - Rogue DHCP Server 13:51 - Wireshark 16:19 - Which Protocols Should You Use? 16:32 - Summary 18:00 - Outro  dhcp ccna mitm kali linux python dhcp attack dhcp mitm ettercap mac address arp spoofing hack hacking hacker ccna v1.1 ccna 200-301 linux 200-301 ubuntu cisco u free ccna scapy free ccna course free ccna training new ccna cisco ccna ccna course ccna certification ccna training packet tracer ccna full course new ccna ccna exam ccna study ccna 200-301 full course cisco training ccna 200-301 course ccna 2024 network engineer free lab ccna course for beginners ccna security free cisco ccna fundamentals ccna full course 2024 ccna tutorial ccna networking  Please note that links listed may be affiliate links and provide me with a small percentage/kickback should you use them to purchase any of the items listed or recommended. Thank you for supporting me and this channel!   Disclaimer: This video is for educational purposes only.  #ccna #kalilinux #hack",
    "description_links": [
        "https://Brilliant.org/DavidBombal",
        "https://davidbombal.wiki/freeccnayt",
        "https://github.com/davidbombal/scapy/blob/main/dhcp-exhaustion-basic.py",
        "https://discord.com/invite/usKSyzb",
        "https://www.twitter.com/davidbombal",
        "https://www.instagram.com/davidbombal",
        "https://www.linkedin.com/in/davidbombal",
        "https://www.facebook.com/davidbombal.co",
        "http://tiktok.com/@davidbombal",
        "https://www.youtube.com/@davidbombal",
        "https://www.amazon.com/shop/davidbombal"
    ],
    "transcript": "this video is part of my complete practical CCNA course where I show you how to configure Cisco network devices in preparation for the CCNA exam now rather than using simulators or emulators I'm using real physical Cisco devices but not only that I'm using modern network devices such as this 9200 CX Cisco switch the goal here is to teach you networking practically so that you can pass the CCNA exam but also use this knowledge in the real world in this video we covering security fundamentals spefic specifically 5.7 configure and verify layer 2 security features DHE snooping Dynamic op inspection and Port security this is the first video in the DHCP Snooping section in this video I'm going to show you how to hack dhp using a simple python script as well as an application running with Inari Linux I really want to thank brilliant for sponsoring this video and supporting my channel so you're watching YouTube videos other videos are recommended to you as you can see here on the right hand side various videos are recommended to me how do an algorithm know which videos to recommend to you is it just some random occurrence or is there some code and logic behind the recommendations well in the how technology Works course on brilliant they have a section on how recommendation engines work and the question is asked if you're watching videos or streaming music both seem to populate your feed perhaps with obscure content why would they recommend content to you that few other users have seen perhaps is it because they run out of popular content to recommend they chose content randomly or they think you'll like this content I think it's obvious that they'll think you like this content but how do they decide what to show you is it based on like dislike ratios view counts topics that you searched for or perhaps they looked at ask a friend so that's the right answer here if a friend of yours watches similar content to you then perhaps if they've watched something you'll also be interested in that content now this course like most courses starts off at a high level but then gets into the nitty-gritty of how things work but notice how interactive this is recommendations are based on a similarity score here's an example of the some method applied to a large set of data jumping ahead in the course we see top videos and just as with similarity scores there are multiple reasonable ways to calculate a video score again very interactive training in the last section we look at real recommenders and we look at the percentage of users you think have seen a particular video on average and they say it's less than 1% again we could select People based on our example and if we get the question wrong we asked to recheck and in this example we get the answer right what's really nice about Brilliant is they cover a whole range of topics like computer science programming statistics Etc very interactive training very Hands-On I really want to thank them for supporting my channel if you use my link below you'll get a special discount to try everything Brilliant has to offer for free for a full 30 days visit https://Brilliant.org/DavidBombal you'll also get 20% off an annual premium subscription if you don't enable DHCP Snooping it's really easy to exhaust the DHCP tool or scope and basically stop devices from getting IP addresses on a network I'll also show you how to set up a rogue DHCP server so that clients such as the Windows 11 computer over there receive IP addresses from the rogue DHCP server but in addition have their default gateway configured as the Kali Linux machine so that when they go to the Internet or other subnets they traffic is sent via Kali Linux so that we can intercept that traffic and capture usernames and passwords as well as other information we are therefore setting up a man in the middle attack by firstly exhausting the DHCP pool on this Cisco router so that IP addresses are no longer allocated from the router when this device requests an IP address the Kali Linux machine will offer an IP address to the client with the default gateway set to Kali which once again means that all traffic that's sent to the internet or a different subnet is sent via Kali and we can capture usernames and passwords so for the CCNA exam you need to know how to configure DHCP Snooping so that you can stop these kinds of Layer Two attacks DHCP Snooping is a security feature that acts like a firewall or Access Control list between untrusted hosts and trusted dhp servers we are going to by default trust no one so everyone is untrusted all ports are untrusted but where we we have legitimate DHCP servers we will trust those ports so that DHCP messages such as offers are allowed from those ports no DHCP messages from servers will be allowed on any other ports okay but before I show you how to configure DHCP snooping let me show you the problem using this Kali Virtual Machine running on this laptop it's connected to gigabit 1/0/1 on this 9200 series switch gigabit 1/0/2 is connected to the Cisco router this is a Cisco quadruple 1 8p router at the moment the Windows computer is not connected to the switch but I'll connect the Windows computer to Port gigabit 1/0/11 to demonstrate the problem and run the man- inthe middle attack now on the first attack I'm running a simple python script to exhaust all IP addresses on the DHCP server you do not need to know the Python script for the CCNA exam but I think it's really important that for the real world you learn Python and see how Python can be leveraged in attacks such as this this is a DHCP starvation attack we are firstly importing scapy scapy allows you to create all kinds of packets in Python we are not going to check the response IP address against the sending IP address that's not required this is the important part we are sending out an Ethernet frame into the network with a destination Mac address of broadcasts so in other words it's a broadcast packet the source Mac address is a random Mac address Source IP address is a bunch of zeros destination IP address is a broadcast Source port number is UDP 68 destination port number 67 so in other words we're trying to get an IP address from a dhp server we are setting the dhp option to discover so it's a discover packet so it's a dhp discover message and we're going to send that packet into the network and we're going to Loop it so ethernet zero on our Kali Linux machine is going to have these packets just continuously being sent into the network now I've connected to the console of my Cisco router so on the router show ip dhcp binding at the moment no IP addresses have been leased DHCP has been configured on this router but no addresses have been allocated if I look at my pool so show ip dhcp pool you can see we have 254 addresses in the pool 10 I excluded none have been leased the range of addresses is this the current index is 192.168.1.7 that's the next IP address that will be allocated if we do a show run you can see that this DHCP Pool has been configured the network is 192.168. 1.0/24 mask default gateway is the local router so show ip interface brief will show that so the legitimate default gateway is 192.168.1.254 that is the layer 3 interface for these layer 2 interfaces on the Cisco router show run again DNS server is Google but notice we've got some excluded addresses 192.168.1.1 2.5 the reason .6 isn't the next available IP address is that was previously allocated to a device and then I cleared the DHCP bindings I've also excluded these addresses 250 to 254 so again show ip dhcp pool notice current IP address range is this we have 10 excluded addresses none have been leased at the moment okay so that looks fine if I plug in my Windows computer it would get an address from this range but what I'm going to do is on Kali Linux open up a terminal ls shows us that we've got a bunch of Python scripts here the one that we're going to run is this basic DHCP starvation script so if I cat dhcp starvation.py you'll see that that is the script I've just shown you so what I'm going to do is run sudo python3 dhcp starvation.py now just before I press enter again show ip dhcp pool no addresses have been leased I'll press enter put in my sudo password a whole bunch of dhcp messages are sent into the network and notice we're seeing here address conflict show ip dhcp pool notice 243 addresses have been leased show ip dhcp binding we can see a whole bunch of addresses have been allocated so basically the entire address poll has been allocated to these random Mac addresses I don't know if you can hear that but the fan on my laptop is starting to go crazy because I'm sending so many packets into the network so what I'll do here is press contrl C you can see 87,340 packets were sent into the network therefore the entire DHCP pool has been exhausted or scope if you want to use a Windows term but notice all addresses have been allocated again show ip dhcp pool all the addresses have been used up no addresses are available for another client current index is 0.0.0.0 100% of addresses have been used total addresses the least addresses excluded no addresses are currently available in the pool so that's the first attack on the Windows computer this network adapter is currently unplugged so what I'll do is launch the attack again just to make sure that no address has become available and I'll plug that cable in to port 11 on the switch so what you see it's saying identifying and if I open up Powers shell and type ip config what you'll notice is on ethernet 10 we haven't been given an IP address we see an IP address of 169. 254.247.192 saying identifying here if you remember this is APIPA addressing or Automatic Private IP Addressing this device hasn't received an IP address from the DHCP server so I'll clear the screen and top ipconfig/renew and try try and get another IP address in the meantime I'm sending all of these requests from the Kali Linux machine I'll back on the router notice we have no IP addresses available and that's because we are continually sending DHCP messages into the network from the Kali Linux machine which is basically exhausting all IP addresses from the pool as you can see here it says an error occurred while renewing interface ethernet 10 unable to contact your DHCP server request has timed out if I look at my IP address notice 169.254.247.192 so no IP address can be allocated to this machine because of my Python script that's exhausting all of the IP addresses now the fans on this computer are going mad so what I can do now is stop that attack as you can see here 359,000 odd packets have been sent out into the network the fan on this computer is going mad because of the number of packets that are being sent by this Python script but as you can see very simple Python script can break a network exhaust the IP addresses in a DHCP Pool which means that no IP addresses will be allocated to legitimate hosts in a network now once you've exhausted the DHCP pool on the router what you could do as an example is set up a rogue DHCP server so in Kali I'm going to go to sniffing and spoofing and run Ettercap it asks me for my sudo password so I'll put that in and there you go there's Ettercap very simple software to use sniffing is set to run its startup the interface that I'm going to be using is ethernet0 so if I open up another terminal and type IP address you can see that ethernet0 is our ethernet interface with IP address 192.168.1.250 so we're going to be sniffing traffic on that interface and then what I can do is click this little accept option and now on the world option I can go to man in the middle menu and I can set up a DHCP spoofing so before I launch that what we've done is taken our the DHCP server on the router we're going to set up this Kali machine as a rogue DHCP server to allocate IP addresses to the Windows computer but have the Windows computer used Kali as its default gateway so that we can sniff traffic going to the internet as an example so as you can see here we're seeing a bunch of discover messages but what I'll do now is set up DHCP spoofing and set up a pool of addresses let's say 192.168.1.1 100 to 125 set up a mask of 255.255.255.255 and I'll set up a DNS server of Google notice spoofing has been enabled and suddenly we see a discover message we're offering this address to the device so IP address being offered is 192.168.1.100 default gateway is ourselves 192.168.1.250 DNS server is 8.8.8.8 we see a request for an IP address and that address has now been assigned so on the Windows computer previously we didn't get an IP address but now ip config shows us that this IP address was allocated but note the difference default gateway is our Kali Linux machine rather than the Cisco router now let's see if we can actually capture usernames and passwords so on my Kali machine what I'm going to do is run Wireshark, Wireshark will allow us to see the traffic in the network and I'm going to capture traffic on ethernet0 as you can see here we're seeing Spanning Tree CDP and other types of traffic but what I'll do is filter for telnet traffic so we see no telnet at the moment now let's assume the administrator of this router did something that they should never have done and they allowed telnet so in other words you as an administrator could telnet to the router notice the vty lines have this password configured and they are allowing all traffic in so transport input all very bad idea IP addresses on the router include this loop back address of 1.1.1.1 so what I'll do is tell net from the Windows computer to that address so I'm going to tell net to 1.1.1.1 I'll make this a bit bigger so put in my password and enable password so telnet password and enable password so notice we've captured traffic in Wireshark and if we scroll down through the traffic we can see c i s c o that's the password cisco not so nice to view it that way so what I'll do is right click and go follow TCP stream and hopefully you can see that the telnet password is cisco I typed enable and the enabled password is Cisco now again it's a really bad idea to use telnet or any other clear text protocol you should be using SSH as an example let's look at another example I'll open up a web browser to another router I have in my network this has IP address 192.168.30.249 that's not this local router that's another router and just before I enter the password what I'll do is filter for HTTP here and notice here we see a get message unauthorized message again really bad idea to use HTTP and what I'll do here is put in my password of Cisco Cisco and there you go I'm able to log to that router but if I go to Ettercap notice we can see information such as the password 192.168.3249 Port 80 username and password information is shown there so Ettercap was able to capture the username and password because they were sent in clear text using HTTP and in Wireshark notice under authorization we can see the credentials cisco cisco so again in today's world you shouldn't be using clear text protocols such as telnet FTP TFTP or HTTP you should be using encrypted protocols such as SSH or TLS so to summarize I showed you how to use a Python script running on this Kali machine to exhaust IP addresses in the DHCP pool so that a Windows 11 computer couldn't get an IP address from a legitimate DHCP server then I showed you how to set up a rogue DHCP server on the Kali Linux machine as well as to allocate IP addresses to the Windows 11 computer but in addition to set the default gateway to Kali so that we could run a man in the- middle attack to capture usernames and passwords now to stop this kind of nonsense we want to run DHCP snooping on the switch and make sure that these ports are untrusted ports and the only trusted Port is this interface to our legitimate dhp server so that we can stop DHCP offers from the Kali machine that once again is Dora way to remember DHCP so we've got a discover an offer a request and an acceptance message we want to stop offers from a rogue DHCP server for example by enabling DHCP snooping and making this untrusted untrusted but allowing this to be trusted so that a discover message goes here offer message goes back request message here and an acceptance message back again now this video is getting quite long so I'll show you how to set up DHCP snooping in the next video I'm David Bombal and I want to wish you all the very best",
    "transcript_keywords": [
        "Kali Linux machine",
        "rogue DHCP server",
        "configure DHCP Snooping",
        "dhcp pool notice",
        "DHCP pool",
        "DHCP server",
        "Kali Linux",
        "Kali Virtual Machine",
        "source Mac address",
        "Mac address Source",
        "DHE snooping Dynamic",
        "DHCP Snooping",
        "DHCP Snooping section",
        "run DHCP snooping",
        "attacks DHCP Snooping",
        "legitimate DHCP servers",
        "DHCP",
        "Access Control list",
        "Cisco router show",
        "broadcast Source port"
    ],
    "transcript_entity_values": [
        "first",
        "Layer Two",
        "python3",
        "169",
        "zeros",
        "TLS",
        "cisco",
        "dhp",
        "Ettercap",
        "SSH",
        "a full 30 days",
        "DHCP Pool",
        "192.168.30.249",
        "359,000",
        "1/0/2",
        "annual",
        "Powers",
        "Cisco",
        "Cisco Cisco",
        "Ethernet",
        "5.7",
        "Port",
        "less than 1%",
        "10",
        "192.168.1.1 100 to 125",
        "9200",
        "CCNA",
        "Kali Linux",
        "APIPA",
        "2",
        "Access Control",
        "zero",
        "243",
        "3",
        "1/0/1",
        "1.0/24",
        "Google",
        "today",
        "CX Cisco",
        "IP",
        "cisco cisco",
        "Kali",
        "Python",
        "Mac",
        "Spanning Tree",
        "1 8p",
        "Dora",
        "DHE",
        "250",
        "Port gigabit",
        "this Kali Virtual Machine",
        "Windows 11",
        "0.0.0.0 100%",
        "11",
        "firstly",
        "192.168.1.7",
        "CCNA",
        "67",
        "Kali Linux",
        "DNS",
        "vty",
        "20%",
        "Windows",
        "87,340",
        "DHCP",
        "192.168",
        "Wireshark",
        "YouTube",
        "David Bombal",
        "2.5",
        "254",
        "CDP"
    ],
    "transcript_entity_types": [
        "ORDINAL",
        "LOC",
        "PRODUCT",
        "CARDINAL",
        "CARDINAL",
        "ORG",
        "GPE",
        "ORG",
        "PRODUCT",
        "ORG",
        "DATE",
        "ORG",
        "CARDINAL",
        "CARDINAL",
        "ORG",
        "DATE",
        "ORG",
        "ORG",
        "ORG",
        "PRODUCT",
        "CARDINAL",
        "GPE",
        "PERCENT",
        "CARDINAL",
        "CARDINAL",
        "CARDINAL",
        "NORP",
        "ORG",
        "ORG",
        "CARDINAL",
        "ORG",
        "CARDINAL",
        "CARDINAL",
        "CARDINAL",
        "ORG",
        "CARDINAL",
        "ORG",
        "DATE",
        "ORG",
        "ORG",
        "ORG",
        "PERSON",
        "ORG",
        "PERSON",
        "ORG",
        "CARDINAL",
        "PERSON",
        "ORG",
        "CARDINAL",
        "FAC",
        "ORG",
        "PRODUCT",
        "PERCENT",
        "CARDINAL",
        "ORDINAL",
        "CARDINAL",
        "ORG",
        "CARDINAL",
        "PERSON",
        "ORG",
        "ORG",
        "PERCENT",
        "PRODUCT",
        "CARDINAL",
        "ORG",
        "CARDINAL",
        "ORG",
        "PERSON",
        "PERSON",
        "CARDINAL",
        "CARDINAL",
        "ORG"
    ]
}