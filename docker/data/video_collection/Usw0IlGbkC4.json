{
    "id": "Usw0IlGbkC4",
    "title": "WiFi WPA/WPA2 vs hashcat and hcxdumptool",
    "channel": "David Bombal",
    "channel_id": "UCP7WmQ_U4GB3K51Od9QvM0w",
    "subscriber_count": 2650000,
    "upload_date": "2022-02-18T15:00:47Z",
    "video_url": "https://www.youtube.com/watch?v=Usw0IlGbkC4",
    "category": "Science & Technology",
    "tags": [
        "wifi",
        "wifi password hacker",
        "wifi password hacker app",
        "penetration testing",
        "ethical hacking",
        "wifi hacking",
        "kali linux",
        "alfa",
        "alfa adapter",
        "hashcat wifi cracking kali linux",
        "hashcat password recovery",
        "hashcat wpa2",
        "hashcat install",
        "hashcat wpa2 brute force",
        "hashcat dictionary attack",
        "hashcat download",
        "hashcat brute force",
        "hashcat wifi cracking",
        "hcxdumptool",
        "hcxdumptool install kali",
        "hcxdumptool commands",
        "hcxdumptool download",
        "wifi gpu",
        "cyber security",
        "wireless security"
    ],
    "views": 692430,
    "likes": 18655,
    "comments_count": 680,
    "description": "Big thanks to Cisco Meraki for sponsoring this video! Learn how to secure hybrid networks so you can stop these kinds of attacks:   Apologies for the glitches in this video  .... looks like the export of this video broke.... I had lots of issues uploading the original video to YouTube and had to export again quickly and it looks like something else broke. Hopefully won't happen again   Disclaimer: This video is for educational purposes only. I own all equipment used for this demonstration. No actual attack took place on any websites. Only use the tools demonstrated in this video on networks you have permission to attack.  // MENU // 0:00  Introduction 1:32  Software used 2:17  WiFi Hardware used 3:15  Commands used 4:17  Install required software method 1 5:31  Install using Github 7:20  hcxdumptool demo using first Alfa adapter 9:15  Demonstration using second Alfa adapter 11:15  Real world example - a warning to all of us 13:45  Use hcxpcapngtool to set format correctly 17:24  Using hashcat with rockyou wordlist 18:38  Using hashcat with GPU and bruteforce   // Previous Videos // Kali Wifi Adapters:  Old method using airmon-ng:  Old method using GPUs:   // COMMANDS // sudo systemctl stop NetworkManager.service sudo systemctl stop wpa_supplicant.service  sudo hcxdumptool -i wlan0 -o dumpfile.pcapng --active_beacon --enable_status=15   sudo systemctl start wpa_supplicant.service sudo systemctl start NetworkManager.service  hcxpcapngtool -o hash.hc22000 -E essidlist dumpfile.pcapng  hashcat -m 22000 hash.hc22000 wordlist.txt  Windows: hashcat.exe -m 22000 hash.hc22000 -a 3 ?d?d?d?d?d?d?d?d  hashcat.exe -m 22000 hash.hc22000 -a 3 --increment --increment-min 8 --increment-max 18 ?d?d?d?d?d?d?d?d?d?d?d?d?d?d?d?d?d?d  // SOCIAL // Discord:  Twitter:   Instagram:   LinkedIn:   Facebook:   TikTok:  YouTube:    // MY STUFF // Monitor:  More stuff:   // SPONSORS // Interested in sponsoring my videos? Reach out to my team here: sponsors@davidbombal.com  wifi kali linux kali wifi kali alfa alfa network alfa network adapter wifi password wpa wpa2 hashcat hcxdumptool linux hcxdumptool hcxdumptoll hashcat  Please note that links listed may be affiliate links and provide me with a small percentage/kickback should you use them to purchase any of the items listed or recommended. Thank you for supporting me and this channel!   #wifi #wpa2 #hashcat",
    "description_links": [
        "https://davidbombal.wiki/meraki",
        "https://youtu.be/5MOsY3VNLK8",
        "https://youtu.be/WfYxrLaqlN8",
        "https://youtu.be/J8A8rKFZW-M",
        "https://discord.com/invite/usKSyzb",
        "https://www.twitter.com/davidbombal",
        "https://www.instagram.com/davidbombal",
        "https://www.linkedin.com/in/davidbombal",
        "https://www.facebook.com/davidbombal.co",
        "http://tiktok.com/@davidbombal",
        "https://www.youtube.com/davidbombal",
        "https://amzn.to/3yyF74Y",
        "https://www.amazon.com/shop/davidbombal"
    ],
    "transcript": "- I really wanna thank Cisco Meraki for sponsoring this video. In this video, I'm gonna show you how to crack Wi-Fi networks using hashcat. (upbeat music) Hashcat is a fantastic password cracker. On the hashcat website they have this document, cracking WPA, WPA2 with hashcat and we are told that since version 6.0, hashcat now accepts a new mode, 22,000. This allows us to more efficiently crack WPA or WPA version two passwords. The benefits of this are listed on the hashcat website including the fact that it combines PMKIDs and EAPOL MESSAGE PAIRs into a single file. Basically, this is a lot more efficient than the old way of having a client connect to an access point and then knocking that client off to capture the four-way handshake. This method does not require a client connected to an access point. So you once again don't need to attack an access point where a client is connected to that access point. You don't have to knock that client off the access point. So in other words kick it off and then get it to reconnect and then capture the four-way handshake. This is a much better way of cracking Wi-Fi networks. Now, from a cracking point of view, having all the different handshake types in a single file makes it much more efficient. So you can read the details on the hashcat website. I'll link it below, but basically I'm gonna show you how you can use the hcxdumptool as well as the hcxpcapngtool to firstly capture the required information to crack the passwords of a Wi-Fi network and then to convert it into a format that hashcat understands. You need at least version 6.0.0 of hashcat to run this attack. Now, before we continue if you enjoy these types of ethical hacking videos, please consider subscribing to my YouTube channel. Please like this video and click on the bell to get notifications. That really does help me with the YouTube robots and it tells you when I've uploaded new content to my channel. I'm uploading a whole bunch of ethical hacking content to my channel this year. So if you enjoy this type of thing, please consider subscribing. Okay, let's continue. In this example, I'm running Kali within a virtual machine on this Windows laptop. I'm gonna be using this Alfa network adapter. This is one of my favorite Alfa network adapters. They are not sponsoring this video. I just find their adapters to be really good. This adapter is great because it works out of the box with Kali. You don't have to install any drivers. So I'll connect that to my Windows laptop. VMware detects the new device and then we asked, where do we wanna connect this device? I'm gonna connect it to the virtual machine rather than to my host device. So hopefully now within Kali if I open up a command prompt and type iwconfig, I'll see that Wi-Fi network which I do. So once again, iwconfig shows me that my Wi-Fi network is wlan0, that's this Alfa network adapter. Now, to make this easier for you, I've put the commands below this video. These commands can be found on the hashcat website. I've adjusted the commands to make it work for my demonstration. So I've had to make some slight changes. I'm for instance not gonna use a word list, I'm gonna use a brute force attack to discover what the password is of the Wi-Fi network. Now, you need two pieces of software. You need the hcxdumptool and you need the hcxpcapngtool. I just wanna interrupt the video at this point. There are two ways to install the hcxdumptool on Kali. You can simply type the command and then Kali will tell you if the application is not available and then you can do a sudo apt install and install the tool. That's the first method that I'll show you, but you may have problems doing that and you may wanna get to the latest release of the software. To do that you need to install the software from GitHub. I'll show you both methods. First method, just doing sudo apt install and the tool. And second method, actually cloning the software from GitHub and then installing it. So if you prefer to use the GitHub method jump to this timestamp in the video where I'll show you how to install the software otherwise continue watching. Before I install the software, I'm gonna do a sudo apt update to update my references. So the first tool that we need is hcxtool. That's not installed by default on this version of Kali. In this example, I'm using 2021.4, but all you need to do is type the command in and then Kali will leave if it's not installed and then ask you to install it. So in my example, it's not installed. So I'm gonna download it and install it. Now, I'm gonna allow it to restart the services as needed. Okay, software is now installed. Next piece of software that we need is the hcxpcapngtool. So I'll paste that command in. It's not installed so I'll type yes to install the software. Software is now installed. Okay, so I've shown you the first method of installing the hcxdumptool. That could work. I have had problems, however, using the software that way so you may wanna get the latest release of the software And that's what I'm gonna show you now. If you're not interested in that then jump to this timestamp where I actually show you the cracking of the Wi-Fi network, but now I'm gonna show you how to install the hcxtool. Okay, so on GitHub, we are going to clone the software. So in Kali, we simply clone that git directory. So in this example, I've got it here. So I've now cloned it to my Kali virtual machine. And then we go into that directory. So PWD shows me that I'm in that directory. Next step is to install some dependencies. So you've gotta install the software. So I'll paste that in. And my example the software is already installed. In your example, if it hasn't been installed, the software will be downloaded and installed. And then what you need to do is use make and make install to install the software. So firstly, make in the hcxdumptool directory. So we can see that that's been done and then sudo make install to install the software. And now, I can use the hcxdumptool. We're told that an option is not used so I can use help to see information about the software including the version so let's look at the version that we've got here. I'm currently using this version of the software. Okay, so that's how you download the latest release. I personally would use the latest release of software. So get it from GitHub and use it, but depending on which version of Kali you may be able to use just a simple install. Okay, so now that that's been done, we can actually look at cracking the Wi-Fi networks. So make sure that you've got the two pieces of software installed. Hashcat is by default installed. So if I type hashcat in Kali, you can see that it's available. Now, we need to stop all services that are accessing the Wi-Fi network so network manager and the supplicant tool. So the two commands that I'm gonna use are these. Once again, you can get the commands below this video. So I'll stop the network manager service and stop the supplicant service. And now that I've done that I am going to ask it to capture Wi-Fi networks. Now, by default, this is gonna capture everything, all Wi-Fi networks. The interface that I'm using is wlan0. So iwconfig will show me the interface to use. So yours may be different, but in my example it's wlan0. I'm gonna dump the output to this file so dump file pcapng. I'm going to use active beacons and I'm gonna enable status one so that I can see the output. Okay, so I'll paste the command in sudo hcxdumptool, interface is wireless LAN zero. The file that we're gonna create is the dumpfile.pcapng file. I'll press enter, the hcxdumptool is now starting. So as you can see there it's continuing. We see EAPOL messages, we see ROGUE information. You basically just need to let this run for a while. Let it run for a few minutes, capture information and then you can start cracking. I'll clear the screen and if we use LS we can see that that dump file has been created. Next step is to start the services once again. So I'll start the WPA supplicant service and I'll start network manager. Now, in this example, I've got another Alfa adapter. This Alfa adapter supports both 2.4 gigahertz as well as five gigahertz, better adapter. I've got it connected to the laptop now. So let's see if this adapter can also capture information from the Wi-Fi networks. Now, before I run the command in VMware workstation player, I'm gonna go to removable drives, Realtek 802.11N network interface card and connect that to my Kali virtual machine. So iwconfig should show me that Wi-Fi interface. There you go. What I'll do is stop the two services. So both those services are stopped. I'll clear the screen and I'll run the hcxdumptool command. Okay, so that's starting up now. Now, in my tests, this takes a lot longer to start up. We told you that this may take some time to begin and that's my experience. It takes a while before it starts running and detecting the Wi-Fi networks and grabbing information from those Wi-Fi networks. So you simply need to wait now for this to start and run. While that's starting up I'll just say that this is one of the best Wi-Fi adapters in my opinion and when in discussions with the Kali developers, they've also recommended this Wi-Fi adapter. So there are various Wi-Fi adapters that you can use. I have created other videos which I'll link below showing you various Wi-Fi adapters that you can use with Kali. Please note with this adapter you will need to install extra software in Kali. Okay, so that's started up now. You can see that it's sending beacons, we're getting beacon responses. We're getting PMKID, ROGUE output. All you need to do now is just wait, let that run for a while. Now, this Israeli security researcher, had an Alfa network adapter. That's another Alfa network adapter strapped to his back. You can see the Alfa network adapter, another good network adapter. And he was able to crack a whole bunch of Wi-Fi networks. So 70% of Wi-Fi network were cracked of the 5,000 that he gathered. He basically walked around and then cracked those Wi-Fi networks. In this example, he was using GPUs in a computer such as this. So the chance of cracking the passwords was a lot better. He used some tricks such as capturing the PMKIDs like we are, but then he realized that a lot of people were using digits in their passwords. So it was easy to crack, but similar to the example that I'm showing in this video because the people were just using digits rather than complex passwords. I've just let that run now a bit longer. And as you can see we've got authentication association messages, we've got EAPOL messages. A whole bunch of information is being gathered about the Wi-Fi networks. And that's essentially all he did. He grabbed information about Wi-Fi networks and then cracked them. Of the networks that weren't using digits, he used the RockYou database. So anyone who tells you that the only way to prove the stuff is to use complex passwords, hasn't always checked what's happening in the real world. Just because people are supposed to do something, doesn't mean that that's what they're doing. They often use very simple passwords. So in my example, simple password on a TP-Link router or in the real world, 70% of passwords were cracked using digits as well as the RockYou database. I've shown you some of those cracks in previous videos. I'll update those videos as well. I wanna do a separate full on GPU test. In this example, this laptop up has a GPU so we can do some basic testing, but I wanna use a bigger computer to do the cracking. I'm not gonna bore you any longer. You just need to wait for that to continue. Let it run for a few minutes, grab a bunch of information from the Wi-Fi networks so that you get the inform of the network that you want and then you can crack them. Okay, so I'll go back to the previous example now where I'm using this Alfa network adapter to do the cracking. This Alfa network adapter is great, but it only supports 2.4 gigahertz rather than five gigahertz. Again, I've shown you in a separate video link below, various network adapters that you can use. So I break that, LS shows me that the pcapng file is available now and now we can crack the passwords here. The important piece now, however, is to use the hcxpcaptool to convert this file, in other words the pcapng file into a format that hashcat understands. So we're gonna convert it to hash.hc22000 because that's what we wanna use within hashcat. This E option gives us a list of SSIDs. So let's run that tool. I'll clear the screen and paste that into Kali. That went really quickly so there's the command once again. It's reading the dump file. It's telling us what's in the file and it tells us that it's processed that file successfully. So LS shows us that we now have a list of SSIDs and we have the hash file. So if I cat the SSID file, you can see a whole bunch of access lists. The Wi-Fi network that we interested in is this TP-Link F3FC, which is once again this Wi-Fi network next to me. All the other networks we are not interested in. Cat hashhc22000 gives us a list of information that's been captured which we can use to crack the Wi-Fi network. Now, you might not know what the Mac address is of the Wi-Fi network. So you can use hcxdumptool once again with the do_rcascan to scan the Wi-Fi networks. Now, I actually started up these services once again so before I use that command, I'll stop the network manager service and I'll stop the supplicant service. So now that I've done that I can scan the Wi-Fi networks in the vicinity. So that'll start hcxdumptool once again. Shows us various Wi-Fi networks that have been discovered, including the Mac address of the Wi-Fi network. Okay, I'll stop that here. This is the one that we are interested in. So we wanna get the BSSID of that network. So let's get that information. The file that we wanna open is this hash file. So to do that I'm gonna use the GUI. So I'll double click on the hash file, it's open with mousepad. What I'm gonna do is copy this and put it into sublime text which will be easier for me to use and edit with. Okay, so this is the BSSID that we are looking for so the Wi-Fi network that we're looking for. I'll search for that and I've found it here. So what I'll do is delete the other lines in the file because that's the only one that I'm interested in and there's another entry here. So I'll delete the other entries as well. This is the Wi-Fi network that we wanna crack. Now, you can do that in Kali if you want to. So what I'm gonna do is copy that information and in Kali I'll move the hash file to a backup file. And then what I'll do is create a new file with the same name. So basically I could have edited it directly within Kali if I'd wanted to but I'll just do it this way. So I've got two files. The one that we interested in is this one. So what I can do now is use hashcat to decrypt that using a word list. So I could use hashcat the file that I wanna crack and a specific word list. That means that I need a word list somewhere. Okay, so I could use the RockYou word list. And that's available under user share word lists. So I could copy that and I'll paste it in my home directory. And then what I'll do is extract that file. So I've got the RockYou word list now. So LS shows us that we've got the RockYou word list there. So what you could do is use hashcat to try and crack the password of the network using a word list. So I'll just show you the command, but that's not the way that I wanna do it because cracking in a virtual machine is really slow. So I'll stop that. And what I'll do is go to the hashcat website. And what I'll do here is download hashcat to my Windows computer. Now, you need 7-Zip software. So you can download the 7-Zip software from 7-Zip.org, just download the exe. So what I can do here as an example is extract this hashcat directory to my downloads directory. So I've got hashcat right there. What I can do now is save this file that I created with the captured information to my hashcat directory. So in my hashcat directory which in this case is in my downloads directory, I'll open up a CMD prompt. That just allows me to open it directly without trying to navigate. So the command that we're gonna use is hashcat.exe. We are going to use 22,000 to crack this file that we've created. I'm gonna use a brute force attack. And what you could do is specify the number of digits. Now, I know how many digits that Wi-Fi network is using, but let's assume you didn't know how many digits it was using. You could increment from say a minimum of eight to a maximum that you specify. So in this example, I'm only using digits so hence D, but you could use alphanumeric if you wanted to. So I'll paste that in, hashcat is starting. As you can see it's using a GeForce GPU inside of this laptop to do the cracking. I can use S to see the status of the crack. You can see that the progress at this point is 2%. It's trying to crack an eight digit password. And all you need to do now is wait for that to crack the password. According to this, it's gonna take about 10 minutes to crack the eight digit password. Now, this video is getting too long so what I'll do is show you in a separate video how to use big GPUs to crack the passwords. A 10 digit password will only take a few seconds to crack when using a high speed GPU. Okay, so after a period of time it's cracked that password. If I run that command again, we're told that we need to use show to display the password. So if I use --show, notice there is the password of the Wi-Fi network and that's the correct password of that Wi-Fi network. That's actually the default password of this access point. And that's one of the problems with TP- Link access points. The default passwords are terrible. You should change them, but there you go that's the default password. Now, in a subsequent video I'll show you how to use bigger GPUs to crack the passwords, how to crack alphanumeric passwords rather than just numeric. A lot of people say, \"Well, David this password is too simple.\" Try and crack a more complex password than that. Now, you should be using good passwords. The problem is people don't do that. As this researcher in Israel discovered, 70% of Wi-Fi networks were cracked because he was using big GPUs and most of the passwords people were using were 10 digit phone numbers. Very easy to crack those types of passwords. He also discovered that he was able to crack a whole bunch of passwords based on the dictionary RockYou. So even though people are not supposed to use these types of passwords, they do. Now, I hope you enjoyed this video. If you did, please consider liking it. Please consider subscribing to my YouTube channel and clicking on the bell to get notifications. That really does help me with the YouTube robots. I'm David Bombal, and I wanna wish you all the very best. (upbeat music)",
    "transcript_keywords": [
        "WiFi networks",
        "Alfa network adapter",
        "Cisco Meraki",
        "network",
        "WiFi",
        "Alfa network",
        "Kali",
        "networks",
        "software",
        "file",
        "network adapter",
        "hashcat",
        "crack",
        "install",
        "passwords",
        "password",
        "show",
        "Alfa",
        "adapter",
        "video"
    ],
    "transcript_entity_values": [
        "first",
        "Hashcat",
        "Cisco Meraki",
        "do_rcascan",
        "Israeli",
        "five gigahertz",
        "BSSID",
        "WPA",
        "7-Zip.org",
        "LAN",
        "6.0",
        "Wi-Fi",
        "the 7-Zip",
        "10 digit",
        "22,000",
        "two",
        "four",
        "a few seconds",
        "eight",
        "Israel",
        "five gigahertz",
        "Alfa",
        "second",
        "this year",
        "YouTube",
        "GeForce",
        "David",
        "PMKIDs",
        "2%",
        "Kali",
        "a few minutes",
        "Mac",
        "SSID",
        "5,000",
        "eight digit",
        "2.4 gigahertz",
        "EAPOL",
        "GPU",
        "VMware",
        "GitHub",
        "firstly",
        "GUI",
        "Realtek 802.11N",
        "the Wi-Fi",
        "First",
        "LS",
        "Windows",
        "2021.4",
        "70%",
        "David Bombal",
        "Wi-Fi",
        "about 10 minutes",
        "WPA2",
        "7"
    ],
    "transcript_entity_types": [
        "ORDINAL",
        "ORG",
        "ORG",
        "LAW",
        "NORP",
        "MONEY",
        "ORG",
        "ORG",
        "CARDINAL",
        "ORG",
        "CARDINAL",
        "LOC",
        "EVENT",
        "QUANTITY",
        "CARDINAL",
        "CARDINAL",
        "CARDINAL",
        "TIME",
        "CARDINAL",
        "GPE",
        "QUANTITY",
        "ORG",
        "ORDINAL",
        "DATE",
        "ORG",
        "ORG",
        "PERSON",
        "ORG",
        "PERCENT",
        "PERSON",
        "TIME",
        "PERSON",
        "ORG",
        "CARDINAL",
        "QUANTITY",
        "QUANTITY",
        "ORG",
        "ORG",
        "ORG",
        "ORG",
        "ORDINAL",
        "ORG",
        "ORG",
        "ORG",
        "ORDINAL",
        "ORG",
        "PRODUCT",
        "CARDINAL",
        "PERCENT",
        "PERSON",
        "ORG",
        "TIME",
        "ORG",
        "CARDINAL"
    ]
}