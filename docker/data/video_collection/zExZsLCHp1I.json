{
    "id": "zExZsLCHp1I",
    "title": "Demo of the Microsoft Window's Hack developed by the NSA (with OTW)",
    "channel": "David Bombal",
    "channel_id": "UCP7WmQ_U4GB3K51Od9QvM0w",
    "subscriber_count": 2650000,
    "upload_date": "2024-04-07T14:00:45Z",
    "video_url": "https://www.youtube.com/watch?v=zExZsLCHp1I",
    "category": "Science & Technology",
    "tags": [
        "nsa",
        "eternalblue",
        "nsa hack",
        "hack nsa",
        "mr robot",
        "rami malek",
        "elliot alderson",
        "mr robot tv show",
        "mr. robot",
        "mr robot hacking",
        "hacker",
        "hacker movie",
        "hacking",
        "kali linux tutorial",
        "kali linux hacking tutorials",
        "kali linux",
        "hack",
        "mr robot hack",
        "hackers",
        "ethical hacker",
        "ethical hacking",
        "hacking tutorial",
        "black hat hacking",
        "learn hacking",
        "ethical hacking course",
        "ethical hacking tutorial",
        "how to become a hacker",
        "ethical hacking career",
        "how to hack",
        "learn ethical hacking",
        "cybersecurity"
    ],
    "views": 73149,
    "likes": 2474,
    "comments_count": 202,
    "description": "OTW demonstrates how to use the NSA hack with Metasploit and take control of a Windows computer remotely.  // Occupy The Web Books //  Linux Basics for Hackers:  US and  UK  Getting Started Becoming a Master Hacker:  US and  UK  Network Basics for hackers:  US and  UK  // OTW Discount //  Use the code BOMBAL to get a 20% discount off anything from OTW's website:   // Occupy The Web SOCIAL //  X:    // YouTube Video REFERENCE // Hacker Saves the World.  Teaches you Hacking:    // Playlists REFERENCE // Linux Basics for Hackers:     Mr Robot:    Hackers Arise / Occupy the Web Hacks:    // David's SOCIAL //  Discord:   X:   Instagram:   LinkedIn:   Facebook:   TikTok:   YouTube:   // MY STUFF //     // SPONSORS //  Interested in sponsoring my videos? Reach out to my team here: sponsors@davidbombal.com  // MENU // 00:00 - Coming up 00:50 - Linux Basics For Hackers book // OTW books 02:38 - Understanding EternalBlue 03:36 - The story of EternalBlue 06:10 - How exploits are created legally 06:44 - White hat vs black hat 07:16 - The story of EternalBlue continued 09:49 - How ransomware works 11:24 - How ransomware gets into a system // Social engineering 14:28 - The Marcus Hutchins story 14:52 - EternalBlue demo 16:31 - The origins of the name \"EternalBlue\" 17:36 - EternalBlue demo continued // EternalBlue using Metasploit 25:36 - Contractors working for spy agencies // The Edward Snowden story 31:23 - How Avast is selling user data 33:40 - EternalBlue demo continued 40:09 - How Mimikatz works // Using Mimikatz to get passwords 42:51 - EternalBlue shown in Wireshark 43:46 - Exploits cause billions in damage // Governments developing malware 44:54 - Shadow Brokers and EternalBlue 45:17 - EthernalBlue in Wireshark continued 49:26 - EternalBlue Python script 52:23 - Learning from the past 53:48 - Conclusion  nsa cybersecurity hack hacking hacker cyber eternal blue windows hack windows windows hacking mr robot kali linux metasploit  #nsa #cybersecurity #hacker",
    "description_links": [
        "https://amzn.to/3JlAQXe",
        "https://amzn.to/43PHFev",
        "https://amzn.to/3qCQbvh",
        "https://amzn.to/43JG2iA",
        "https://amzn.to/3W1iiCQ",
        "https://amzn.to/4aInbGK",
        "https://hackers-arise.net/",
        "https://twitter.com/three_cube",
        "https://youtu.be/sxCUZFVM8xk",
        "https://www.youtube.com/watch?v=YJUVNlmIO6E",
        "https://www.youtube.com/watch?v=3yiT_WMlosg",
        "https://www.youtube.com/watch?v=GxkKszPVD1M",
        "https://discord.com/invite/usKSyzb",
        "https://www.twitter.com/davidbombal",
        "https://www.instagram.com/davidbombal",
        "https://www.linkedin.com/in/davidbombal",
        "https://www.facebook.com/davidbombal.co",
        "http://tiktok.com/@davidbombal",
        "https://www.youtube.com/@davidbombal",
        "https://www.amazon.com/shop/davidbombal"
    ],
    "transcript": "EternalBlue was an exploit that was developed by NSA, the National Security Administration in the US. And basically what it allowed them to do is to basically take over and control any machine, any Windows machine, let's be more specific, any Windows machine. This is what makes this such a power, powerful, powerful exploit. So this kind of gives us, you know, we can do all kinds of things, we just do the help screen and then it shows us we can do a hash dump on it. We can get the system if we didn't already have the system. We could use Mimikatz to get all the passwords on the system. You can do a key scan. Most of these will work. Like we can clear the EV. Hey everyone, it's David Bombal back with the amazing OccupytheWeb. OTW, welcome. Thank you, David. It's always an honor to be on the best YouTube channel for IT and cybersecurity. I'm always, you know, thankful that you say that and you're one of the reasons for that. Just for everyone who hasn't seen our previous videos, amazing videos that I've done with Occupy the Web. He's the master at this, so really appreciate you sharing your knowledge. But you've also written a bunch of books. So have a look at this book, Linux Basics for Hackers. Very, very popular. OTW, still very popular on Amazon, right? Oh, yeah. It's still the best-selling Linux books, Linux book on Amazon, even though it's five years old. We hope to have a second edition out before 2024 is out. We do have the video companion to the second edition at Hackers Rise, but we don't have the printed version of the book out yet. That's up to no start. I'll put those links below. OTW, you've also written this book, right? One of my favorites, Network Basics for Hackers. Very good. Yeah, Network Basics for Hackers. That's been a very good-selling book. And also we have the Getting Started, Becoming a Master Hacker. And the reason I bring that one up is because in that book, we do an in-depth study in there of the EternalBlue exploit that was developed by the NSA and was stolen. So we look at it from a lot of different perspectives, from a Wireshark perspective, from a Python perspective, from a Metasploit perspective. We look at it from a vulnerability scanning perspective. So we use it throughout that book to understand better how that particular exploit works, because it's one of the most important exploits in the history of hacking, which brings us to what we're going to talk about today. We're going to talk about EternalBlue. I'm really glad you're doing this because there's a lot of interest, right? Well, people keep on telling me there is. It's now a seven-year-old exploit, and so you're not going to find many systems that are actually vulnerable to it. But what it is useful to us, to all of us in this industry, is to understand the development and the functioning of an exploit like this, an exploit that basically could take over and control any Windows system, any Windows system at the time it was developed. And so it still has some usefulness, but most of the systems have been patched by Microsoft. But we can learn a lot by studying. So that's why I highlighted it in my 2019 book, Getting Started Becoming a Master Hacker. So let's just tell the story behind EternalBlue. EternalBlue was an exploit that was developed by NSA, the National Security Administration, at the U.S. And basically what it allowed them to do is to basically take over and control any machine, any Windows machine. Let's be more specific, any Windows machine. At that time, it was limited to Windows 7. It's now been ported to Windows 8 and Windows 10. So it gave the NSA the ability to spy on any Windows machine on planet Earth, and maybe some of those that are not on planet Earth. And so, and none of us knew about it. Nobody knew about it. NSA was using it to spy on the people they wanted to spy on. They basically could point this exploit at any machine, any Windows machine. Let's be clear, Linux machines is not vulnerable to this, or Apple Mac machines are not vulnerable to this exploit. But any Windows machine, which means 90% of the systems that are out there. And we didn't really know anything about it until it got stolen. So it got stolen in, I guess it was still the winter of 2017. A Russian hacking group, okay, came in and stole it. It appears that it was stolen from a NSA contractor who had taken it home. He had taken it home, and then he got hacked, and all of the materials that he had were then stolen by this group. And then this group went ahead and put it out on the internet to sell it. So they put it out for auction. They were going to auction it off to anybody who wanted it. And they got, it was all by Bitcoin, they received no bids. You can only imagine why they received no bids on it. They received no bids on it because they knew, people knew that it belonged to NSA. And if you purchased it, you would immediately become a target of the NSA. NSA is not going to buy it. You've got our prize possession that's worth millions of dollars, and they may have paid millions of dollars for it. And one of the things that we've talked about here before is that there is an industry, there's an industry in the world that produces exploits, hacks, call them, exploits, hacks, that do this legally and sell them to governments. If you develop an exploit and you sell it on the black market, it's a chronic. If you sell it to the government, it's legal. Of course, the government makes the rules. Exactly. And your government may be different to my government. Yep. Right. Exactly. So one country is going to be illegal, another country. And so this all gets kind of convoluted, you know, what's the difference between a white hat and a black hat. And I talk about that in my books is that, you know, that terminology is maybe antiquated because I could be a white hat in the US, but be a black hat in Russia, vice versa. Right. Yeah. So what am I? You know, so maybe it's just maybe it just is terminology that we should put the bed and talk about just hackers in general. But this particular exploit was then stolen and put out for bid. Nobody bid on it. So the Russian group, all right, we're pretty sure it's a Russian group, then just basically gave it away. Okay. In March, March of 2017 and Microsoft gave it the designation of MS17-010. So that's the EternalBlue. And the beauty of this is that it probably took years to develop. It's probably worth millions of dollars. And then this group put it out to the public. Okay. In March, immediately Microsoft patched it. It is a flaw. It's a vulnerability in SMB server message block. Right. That's the protocol for 445 that allows machines to be able to share resources between them. It's server message block has been a problem from the beginning of local area networks, Microsoft and Linux local area networks. I mean, there's been a lot of Samba is the equivalent in in Linux and the Unix world. And it's had its problems as well. And so the part of the problem is that it's, you know, it allows this sharing between different machines. So if you can break it, you can get inside of the system with system admin privileges, and then also traverse to the other machines on the network. So it's been an issue. It's pretty complex. The folks at NSA figured out a way to break it. And it requires, if I remember correctly, SMB one and SMB two to be installed on the system. It takes advantage of those two protocols, not working well together. So they went ahead and the Russian group put it out on the internet. And then immediately, immediately, everybody seized upon it and started using it. And we saw a whole proliferation in this is the spring of 2017, a proliferation of ransomware, particularly, right? There was a lot of people just hacking Windows seven systems and Windows eight systems with it. But we saw a proliferation of ransomware, including Petia, not Petia, WannaCry. They all used EternalBlue. One of the things that you have to understand about ransomware is that ransomware inside the system is not that different, right? Basically, what ransomware does inside of any computer system is it tries to, first of all, it starts a process, then that process goes and searches for all the storage devices. And then that process then looks for files with a particular type of extension like doc, XLS, PDF, all of the things that will be valuable files to you, whoever you are. Like we've seen some hospital systems this week have gotten hacked. And so it might even include SQL files I've seen. And usually there's a list within the ransomware. You'll see a list of about, oh, maybe 50 extensions. So the ransomware goes and looks for all of those files. So it goes out and it finds all those files and then it begins to encrypt them. So that part is pretty standard within any ransomware. There's going to be variations, but that's the process that ransomware does. But the key is how does the ransomware get inside the system in the first place? And so that's a harder task. Once you're inside, running the ransomware and encrypting all the files, starting a process, finding the storage devices, finding the extensions and then encrypting them, that's almost boilerplate at this point. The problem that all ransomware has is how you get inside the system. Well, of course, there's always social engineering. Get somebody to click on a link. Click on a link, click on open a document, open up a JPEG file. All of these are ways of getting inside the system. And they all of the cyber criminal groups and the cyber intelligence groups use these techniques. So as I've said in previous videos, don't underestimate social engineering because social engineering is used by everybody within this industry, within this industry, within the industry of exploitation and hacking and intelligence. So sometimes you're lucky to have an exploit like a EternalBlue that allows you to simply point at an IP address and take it over. But that's more the exception than the rule. The rule is you have to find a way inside. So what happened when this particular exploit was given out to the public and not everybody had patched because immediately people don't always patch immediately. Despite those of us in the industry, we all encourage patching, but we also recognize that people don't always patch immediately, even big commercial organizations. Why not? Well, because sometimes the patches will break the system, they'll break the other software on the machine. So you have to, before you patch your production system, you need to test it in the laboratory environment to make sure that everything is going to still work after you patched it. You don't just, if you're Amazon, you don't just automatically put a patch in place and all of a sudden it breaks all your other software and you're down for days a week. No, that's not, that's not wise. Right? And so anybody who's got a production server is going to test it and take a while before they actually apply a patch because we know from history that not all the patches work the way they're intended to. And they might work the way that Microsoft intended it to, but it may not work the way that we want it to because we have software, maybe it's we have unique or custom-made software for our environment that hasn't been tested on this with this patch. So these are all the considerations that people have in terms of patching systems. So when a new exploit is developed and it's out there like internal blue was for the criminal gangs, it's there's a window and that window is open. Sometimes longer than you expect, you can actually still find some unpatched Windows 7 systems out there now. Okay, Windows 8 systems. You still can, but there's a, it was a big window open in early 2017 and all the criminal gangs were trying to take advantage of it. And so we ended up with Petia, not Petia, WannaCry, which thanks to Marcus Hutchins, he was able to short circuit that particular and that used EternalBlue too, but Marcus was able to short circuit WannaCry by finding the URL for the command and control server, which is an excellent story that you have not familiar with this. Check it out. I think Marcus has some videos discussing it, but so what I want to talk about today is EternalBlue. And so let's take a look at it and I'll be using, I'll be using an unpatched, I kept an unpatched Windows 7 system, right? It's a virtual machine of a Windows 7 system. And I'll be using, this one is like a Cali 2020. So it's not the latest and greatest, but you don't need the latest and greatest to do it, right? This is, it's been part of Cali since like 2017. And what has happened is that it's been, the exploit has been reverse engineered by a number of people as play has been placed into Metasploit and other places. So let's go ahead and log in. It'll be part of your system, no matter what, basically whatever year you're using with the exception if you're using a really, really old Cali, let's go ahead and let's do, first of all, let's go ahead and do a search exploit. Let's see what we find here. SearchSploit allows us to go ahead and search, okay, for any exploits that meet that particular criteria. And you can see here that in this one here, we have a Windows EternalBlue SMB remote code execution there. I got the number right. Yes, I remember it correctly. So we can see that we found a few, three of them, three exploits by just going SearchSploit EternalBlue. That's the name that the folks at our good friends at NSA gave it. I don't really know where that name came from, but I will tell you that the best I can figure out where that name came from is that at the time that this exploit was developed, there was a Netflix series on Genghis Khan. And Genghis Khan makes reference to EternalBlue. And so I had never heard the term before. So that's the only clue I have is where that name came from. I've never heard anybody else speculate as to what, where it comes from. So let's go ahead. For people watching, put in the comments below if you've got a theory. If somebody knows where it came from. Yeah, the only place I've heard that term used, almost simultaneous to the development of this exploit was a Netflix show. Oh, let me see if I can just find it. I can't find the name. But it goes, I'm Genghis Khan. And if you guys know about it, let me know. If you know where the name came from, I'd be really interested in finding it, because I've never heard anybody come up with a good explanation of where that name, Eternal Blue, came from. So let's go ahead. And so we can see that there's at least three exploits. We can go into MSF console, which is the Metasploit, right, which is, if you're not familiar with it, you know, there's in our exploitation tools, we can see here's a Metasploit framework. And we can just start it by either clicking on that or just go on MSF console. Metasploit is a tool that has a lot of hacking cybersecurity tools built into it for doing pen testing. It doesn't have zero days. It has known exploits, right? Known exploits. And it's one of the things as a pentester you need to do is that you need to try the known exploits first, and then if you can actually hack a system with just your knowledge of the system or develop your own zero day, all the better. But the first thing you need to do is try the known exploits. As I always say, is that if you're the head of information security for a firm, and your company gets hacked by a zero day, that's forgivable. Right? Oh, well, you know, we did our best and we got hacked by zero day by some criminal group or the Russians or whoever. But if you get hacked by a known exploit, then that's not forgivable. Right? And you're fired. Unfortunately, that doesn't happen enough. In other words, that people don't get fired for it because you should never, your system should never be exploitable by known exploit, known vulnerabilities and known exploits. That's your primary job, is to make sure that you don't get hacked by those that are already well known, like EternalBlue and so many others. Let's go ahead and take a look, do a search. And this tool has a lot of those older known exploits in them. And we can go in here and you can see there's an auxiliary module here. And this auxiliary module basically, this one looks for the presence of what's called Eternal Romance. EternalRomance is the shell code. It's the shell code that this particular exploit placed inside the Windows system. Then there's another one here that is, yeah, these are both looking for the exploit. Let's looking, yeah, scanning for whether or not they're vulnerable. Let's try this one out right here. Let's go and copy it. And the key word in Metasploit is use. All right. And we're going to go ahead and paste it in there. It's an SMB scanner. And I'm going to go ahead and clear so we can see it better. And then just do an info on it. So this uses information disclosure to determine if MS 17.010 has been patched or not. All right. That's what we're trying to do first. Like any exploitation, the first thing you need to do is do your proper reconnaissance. Otherwise, you're going to be wasting your time. So we're going to go ahead and then do show options. And you can see here that it's, these are the name of various variables. Okay. And then here's the setting and here's the required and here's the description. So when you're working in Metasploit, first thing you need to do is check to see whether or not these, any of these are required. If they're not, you don't have to do anything. If they, if they do, okay, yes, then you got to make sure that there is something there. And you can see that it targets port 445. All right. You can put in the SMB domain, SMB password, SMB user, but very often you don't have to. So next thing I got to do is I've got to go check to see, to put in the R host. R host is remote host. This is the target. That's the terminology that Metasploit uses for the target and it's required. So basically the only thing I really need to do here is to put in the R host. So let's go open up my windows seven system, my vulnerable windows seven system. Okay. And we've got all kinds of malware on this system, some tick tock, some tick tock malware. Imagine that tick tock malware and wanna cry. All right. We won't go into tick tock, but I developed some malware and called it tick tock just for demonstration purposes. All right. All right. 109. All right. Let's make sure, let's go ahead and try that. So set our host to 192, 168, 109. Our host was the old terminology, our host, the plural is a new terminology. They're basically linked. So either way it worked. You can see it set our host here. All right. So, so now what we're going to do is just go to see whether or not this system is vulnerable to EternalBlue. All right. So let's go ahead and just do, you can either do exploit or run. Okay. Ah, it's vulnerable. Look at that. Okay. Great. Okay. So we know the system is vulnerable. All right. And basically it's, it's having SMB one and two on the same system. Right. If you take out SMB one on these systems, they're not vulnerable anymore, but oftentimes because of legacy systems on the network, people will still leave in SMB one with SMB two and SMB three. And the whole network then becomes vulnerable. So you can see here that this was, this particular exploit, this is actually a scanner was developed by Sean Dillon at RiskSense. Okay. So give him some, a shout out. And basically what it does is it just goes and checks to see whether or not there's that service of SMB one and SMB two on the same system. Next, we're going to go ahead and look for the search and then we'll go type and then exploit the little lesson on how to use Metasploit for, oh, what I really wanted to do was exploit and then EternalBlue. I get, I just put in exploit. I get lots and lots of exploits, 2044 in this case. But I want very specifically this one right here. All right. And I'm going to copy it and then use it. And I'm going to repeat that if you're using a newer, newer Metasploit, that's fine. If you're using an older Metasploit, it's probably going to be fine as long as it's older than 2017. Right. This has been built into Metasploit and to Kali for seven years now. So either one is going to, it's going to work pretty much the same. There's not going to be really any big differences. When they came out with Metasploit five, like in 2018, Metasploit changed in subtle ways and made it easier to work with what have you, but you could still even use some of the older ones or the newer ones. Either way, it's not going to make a whole lot of difference in trying to use this particular exploit. First thing I always do is I want to know what is it that I'm working with here. I'm going to go info. And you can see that this is this module's part of the equation group, EternalBlue Exploit. So what's the equation? Equation group is a contractor to the NSA. You know, I've talked about this before that, you know, whether you be in China or whether you're in the U.S., whether you're in the U.K., whether you're in Israel or you're in Russia, each one of those intelligence agencies uses contractors, right? They use contractors to do a lot of their work. So all the spying isn't being done by the spy agency. They work with private companies who do a lot of the development and actual spying for them. As a matter of fact, those of you who are familiar with the Edward Snowden story, right? Edward Snowden is the fellow who revealed all the information about NSA, I think 2013, 2014. I don't remember exactly what year, it was right around there. And he left and spilled all this information to the world. So we know a lot about how the NSA works based upon what he spilled. Unfortunately, he's living in Russia now to try to avoid prosecution in the U.S. But the reason I bring up that story is that when Snowden, but most people know him as an NSA employee, but he really wasn't an NSA employee. He was an and he was an employee of a contractor. And the contractor he was working for was Booz Allen Hamilton. Okay. Booz Allen Hamilton is one of the premier cyber security technology management consulting firms in the U.S. And they have offices all over the world. And they work closely with NSA. Snowden was actually working for Booz Allen Hamilton, who some of their employees are students at Hacker's Arise. So just stick that in there. Okay. I like it. Those of you at Booz, I'm giving you a little plug here. Okay. Because you guys have come to study with us. We love you. So anyways, Booz Allen Hamilton was the employer of Snowden at the time and they do a lot of work with NSA. This was probably Booz Allen Hamilton. Nobody knows for sure, but the equation group was probably a division of Booz Allen Hamilton. They've been around for a hundred years, but they really specialize in cybersecurity and technology management consulting. And they've gotten really close ties to the U.S. Department of Defense and the intelligence community. And they run many of the spy facilities in the U.S. and around the world. And Snowden was working at one of them in Hawaii at that time. So let's go. We got some information about it. We know, let's go up here and look at the, our hosts, our host or our hosts both work with Metasploit. Our port, it has to be, although you can change the port, it's not going to work. Okay. If you do, because SMB is on port 445. Right. So really the only thing this requires is that we go ahead and point it at an IP address. That's the power of this particular exploit is that in 2017, the NSA had the capability of pointing this exploit at any system and taking control. So that's what we're going to be doing. We're going to be replicating what NSA was able to do up until 27. And now I'll bet sure that they have something similar, but we don't know about it yet, but we probably will down the line. Okay. So let's go and go set our hosts. Snowden's revelations were quite a wake-up call for many people, right? And governments. Oh yeah. It's Snowden's revelations were really an important milestone in the history of hacking and intelligence gathering because he showed that the NSA was spying on lots and lots of people, including leaders and leaders of friendly governments. Right. That they were listening in on conversations of Angela Merkel and other leaders that were friendly governments. And that also that the major players in the US, who the major players in the US are the major players in the world, the social media companies, the mobile companies were giving them unfettered access to the pipe. That means that they were saying, oh, well, you know, this is for national security reasons. So of course we'll give you access to all of our pockets going across our stream. And that was really eye-opening for the rest of the world. I don't think it was eye-opening for anybody within the intelligence community because we all know what they do. Right. And we know that, you know, if you're at Microsoft, think about this. If you're at Microsoft and the NSA comes to you and says, look, we really, you know, this is national security, say this is like 2002. All right. And we just had 9-11. And it's really important that we suspect there's going to be another terrorist attack. And we need to put a back door into all of your operating systems so we can track this potential attacks. What do you think Microsoft's going to say? Well, I would like to think, I would like to think they would say no, but in reality, what they say is yes, we know this from experience, right? They say yes. And they give access. They say this is national security. Lives will be lost unless you give us a back door into your operating system. Or, you know, one that is a revelation of this last couple of weeks is that Avast, the anti-virus company has been gathering information off your browser and selling it. Okay. That's crazy. Yeah. AV software is one of those that you really have to be careful of because you're really giving the AV software access to everything on your system. And if they decide to use it or sell it, then it's not any different than say TikTok. TikTok gathers all this information off your system and they put it into a repository, which the Chinese government, if they want to, has access to it. Now, I'm not saying that they're selling it to the Chinese government, but they have an agreement with the Chinese government, says the Chinese government wants it, they can have it. That's not that different than the US companies that don't refuse the NSA when the NSA says, we need your data. But your AV companies, right? There's a lot of those out there. A lot of AV companies. And some people are going ahead and giving away free AV, free AV, right? So I install your AV on my system and they take all my data. They can see all my data. And with Avast, we now know that's what they're doing. Avast is stealing. It's crazy. They're taking all your information and then they're selling it to the highest bidder. That's a dangerous situation. So as I always say, and I didn't originate this phrase, but I certainly live by it, if a service is free, you are not the customer. You are the product. You're the product. They're selling your data. Why else? What would be the business model? What would be the workable business model to giving away a free service? The free service is they're selling you. You're giving away your information and they're selling it to somebody else. Okay. So just be careful. So let's go ahead and put in our hosts like this, 192.168.109. And then we're going to show options before we do anything. And we can see that all the things that are required are there. Since Metasploit 5, it will automatically load a payload. So if you're using an older version, you have to load a payload with Metasploit 5 and later it automatically loads an appropriate payload. All right. In this case, Windows 64, Meturperter reverse TCP. Let's go through each one of those sections there. This means that it works against Windows systems. It works against 64-bit Windows systems. It implants shell code that is referred to by Metasploit as the meterperter. Okay. That is a special piece of shell code that Metasploit has developed that enables it to run special post-exploitation modules and scripts against the targets. So it has more power than a normal shell would. And then reverse TCP means that it uses TCP to communicate, but it's reverse, which means that it will call back to you. So once you implant this shell code onto the system, so we've got to think about exploitation. Just like we talked about ransomware, you have to get inside the system first, and then you have to plant something there. In the case of ransomware, we get inside and then we plant the ransomware that does all the encryption, finds the storage device, finds the extensions, and then encrypts all that data. And this one here, we're getting inside the system. Okay. That's what the exploit does. And then we're planting inside the system, a meterperter shell. All right. That's going to give us control over that system. So let's go ahead and see. You see down below this particular one works against Windows 7, Windows 8, Windows 2000, 8 server. There are also versions that run against Windows 8 and 10, both, okay, if the right conditions are in place. Let's be clear, okay, if the right conditions are in place. It's still requires that it has SMB1, SMB2. I also want to put a little plug in for my network basics book is that we talk extensively in network basics books about SMB. So if this is a mysterious protocol for you, take a look at it. And we do a whole chapter on SMB. And the reason we do that, I tried to work with some of the major protocols so you have a better understanding of how they function and then how you can break them. And here's one of the ways that you can break SMB. So let's go ahead and do an exploit and say, keep our fingers crossed, say a prayer to the hacker gods, and maybe we'll get inside. And we're still waiting. Sometimes if you have to wait a long time like this, it usually indicates it's not working. And that's, you know, this is a tried and true exploit that has been around for a while. They're kind of just, it failed. All right. I'm glad that happened, because it kind of shows that even with an exploit that has been well known and well tried for years now, it sometimes fails. Oh, and then we did a win even better. We did a fail and a win. So this one will try three times before giving up. And then if we go up above, it'll, oh, we have to go into the advanced settings. We can change the number of tries that it makes in the advanced settings, but we got it. You see, we have a meterpreter prompt on that system. So we can go sysinfo, you can see it's my PC, Windows 7, 64 bit. We can do a dir and it'll give me all the Windows directories. And I can do an ipconfig, among other things. I can basically, I have system admin privileges on this particular machine that gives me total control. Those of you who aren't familiar, you know, when you get inside, you can see that I have a system admin privileges on this particular machine that I'm not familiar. You know, when you get inside of somebody else's system, generally you're going to get in as a regular user, right? And so you're going to be limited by the privileges of that user, which means you're not going to have total control. You're only going to have the control of that user. If you can get inside as a system admin, you have total control over the system. You can do anything you want. And this is one of the beauties of EternalBlue. It comes in as system admin. Very often as a hacker, you'll come in as a regular user and then you have to work to be able to escalate privileges to sysadmins. So this is what makes this such a powerful, powerful exploit. So this kind of gives us, you know, we can do all kinds of things. You know, we can do the help screen and then it shows us we can do a hash dump on it. We can get the system if we didn't already have the system. We could use Mimikatz to get all the passwords on the system. You can do a key scan. Most of these will work. Like we can clear the EV. I also want to put a little plug in that we saw a anti-forensics technique this week being used using the MSB util command in Windows. And that was something that I outlined in my book, Getting Started, Becoming a Master Hacker. I hadn't seen any malware using it until this last week. So somebody's reading my book. We use that technique in my anti-forensics class as well. Let's just do a quick hash dump, right? And we can just see all the hashes. There's the hashes. And then of course, if we wanted to continue to work on this system, we could take each one of these hashes and run it against something like HashCat or other hash cracking tools. We could also load in, there's a post-exploitation module in Metasploit called Mimikatz, which is a really, and we've seen Mimikatz being used in a lot of malicious malware. What it does is that it goes into RAM of the system that you've exploited and pulls the passwords out of RAM. Because the passwords, after a password is used, it stores it into RAM in clear text. And so Mimikatz, which was developed by a fellow by the name, it was by the name of Gentle Kiwi, he developed this bit of software that will go into RAM and pull the passwords out in clear text. Microsoft keeps on combating it. Gentle Kiwi keeps on improving it. And they go back and forth on that. But it's a really good piece of software. And we've seen it used in lots and lots of the malware that's around the world. People will first come in and they'll exploit a system and then they'll run Mimikatz, is what it's called, Mimikatz, M-I-M-I-C-A-T-Z. And it'll go into the RAM and pull the passwords out. Those of you who are Mr. Robot fans may have remembered that Angela, I don't remember what season it was, maybe it was season one, near the end of season one or season two, Angela has to go get her boss's password. And she basically social engineers him away from his office, away from his machine. And she uses a thumb drive with Mimikatz on it and then goes ahead and executes it on his system to get his password. So it can be used on a thumb drive externally, or you can use it through Metasploit. Either way, it's one of those pieces of software that any hacker, pentester should be familiar with. And its value is clear by how many malicious and intelligence community hacks use Mimikatz. The guy's name, gentle kiwi, is actually Benjamin Delpy, which by the way, he's a guy that I'd like to see you invite on your show. Benjamin Delpy is an interesting character. So Benjamin Delpy developed that and keeps the gentle kiwi, he keeps Mimikatz going. Now, so we've gone ahead and used it. Let's take a look at what it actually is doing from a Wireshark perspective. These are actually, I've taken the exploit, run it against the system, and then I've captured the from Wireshark, I've captured the key packets showing you the negotiate, you know, the protocol request and response, right? What's called a tree connect. Okay, in this case, it's to 192.168.198.203 and the IPC. So what this is doing is it's initially just trying to connect to the SMB initially. And then what it does is you can see here does the trans to request setup trans to response. Okay, it keeps on trying to do this trans NT trans response. And this is sending packets, what it's trying to do is take SMB one, SMP two, and divide an integer in them to get a Oh, yeah, I also forgot that the city of Baltimore was attacked by this tool years later. That's a good example of somebody who didn't patch for a long, long time. We talked about Petia, not Petia, and WannaCry being, you know, using EternalBlue. Those attacks cost billions of dollars, those billions of dollars of damage there, in both lack of uptime, okay, by certain companies, and the ransoms that were paid. So it was, it was really had a big impact on the world. Yeah, The lesson they write about governments developing exploits. I think there definitely is. I mean, I think that we can't ignore the fact that when governments develop these exploits that there's a good chance they're going to get out and cause a lot of damage. Like the UK government wanting to get back doors in encrypted protocols, like when applications like WhatsApp and VPNs and stuff, it's like, if they can do that, at some point, a hacker is going to get access to it. Exactly. Yep. So one of the things we also didn't mention is beginning was that it was the entity who stole it was called the shadow brokers. So just kind of put that out there. We didn't mention that we mentioned it was a Russian group, but they went by the name shadow brokers. All right. And they are the ones who went ahead and sold it. EternalBlue relies upon a mathematical error when it's trying to create what's called an NTFEA structure, okay, from where basically, this is where the amount of memory is being allocated. And then there's a miscalculation that creates an integer overflow that causes less memory to be allocated than expected. This requires, okay, both SMB1 and SMB2. And then this triggers a buffer overflow. The buffer overflow then is going to allow the transaction tool and the NT Transact, these right here, to be able to put too much data into the packet that allows the buffer overflow to take place and then allows the attacker to put in their own remote code. In this case, we put in the meterpreter. I'll show you some more examples of what's going on here from the Wireshark perspective. Okay, so here's the NT Transrequest. These are the things that are going ahead and trying to put in too much data into the particular memory area. Remember that the most powerful exploits are usually buffer overflows. And so this requires that you identify a memory area that basically doesn't have bounds on it. It doesn't have bounds. Bounds are ways to limit how big the memory area can be. So in this case here, they were able to find a variable that was unbounded and then overflow it with these NT Transaction requests. I'll show you. Here's the data count right here, 66.512. And let's go to the next frame here. And so here's the NT Transrequest header. This is all sending the data into the area that's being overflowed. And then ultimately, you're getting here the status invalid parameter, SMB2. You can see it right there. So this is where it's going ahead and putting too much data into that particular buffer. And this then allows the attacker, us, to be able to put in a payload, a shellcode, in that allows us then to take control of the system. Because SMB has system admin privileges, it allows us then to come into the system with system admin privileges and take total control over the system. So this is what's going on behind the scenes. This is actually the exploit as it's sending packets to the target. And we can view them through Wireshark. And all I've done here is to filter by SMB and see what each one of the packets are doing to the SMB in this particular exploit. I also have a script. And once again, I want to give some credit to Sean Dillon and some others who reverse engineered this exploit. Sean Dillon, I think, is that company called Risk Sense. And a lot of people, when this first came out, were trying to reverse engineer it. And I think Sean was the first one to effectively do it. In my book, Getting Started, Come Master Hacker, I also have the Python script for exploiting. This is obviously we were using a Metasploit script, which was written in Ruby. But we also have in that book the Python script that does exactly the same thing in terms of exploiting Windows 7, Windows 8, Windows 10 systems with SMB1 and SMB2. So let's be clear that those two are requirements to be able to exploit the system. So if you're using this against a Windows 10 system and it doesn't work, well, that's because probably it doesn't have SMB1, SMB2 together. That's where you get the miscalculation that creates the integer overflow that generates the buffer overflow. All right. This is the start of it. And so it uses a number of modules and it imports each one of those. That's all this is doing here. It's just importing the various modules. You can see that's getting my SMB, which is a module in Python and some others. And this is MS1.01, MS17.010, for Windows 2000 and later. And it goes through, it's tested on all of these systems, including 8.1, Windows 10. And then if we scroll down this a bit on this, we can see a little more of this. Can't get it all on the screen. It's actually a pretty lengthy script. Like I said, it's all in my book, Getting Started, Becoming a Master Hacker. And basically it's going ahead and finding the name pipe. So it uses the name pipe to be able to get inside the system. You can see some of the functions that it's creating to do that. And then here it's going through and going through an if then else, trying to determine whether or not they can overflow the buffer. That's what is going on here. If, elif, else, if the target's 64 bit, 32 bit, it's basically determined. I guess this right here, I look at it closer, it looks like it's trying to determine the type of operating system. Either it's x86 or x64. That's what it's doing there. And then there's a for statement. Now those of you who are familiar with Python, it's a for i in range of 10. Goes ahead and align the transaction and leak. If the leak info is not done, break it. In this case, if the leak failed, try again. And it keeps on going through, trying to create this buffer overflow in the SMB by sending these NT transaction packets that cause a miscalculation in the integer overflow, which then creates a buffer as well. So that's the basics. It's not all of it. It's the key part. You can see it's 500, this one, 522 lines of it. I just took out some key parts of it to show you the whole script is in my book, Getting Started, Becoming a Master Hacker, where in several other chapters in that book, we go through looking at EternalBlue from different perspectives, from trying to do a vulnerability scan on it, using it in Metasploit, creating a Python script to exploit it, and a few other places. So we also use Wireshark to analyze it. So we do a case study on EternalBlue, because it's such an important exploit in the history of hacking. That's great. I think we've discussed this before. You can learn so much by looking at the old stuff, even though it's not perhaps going to work today. But you just learn the process. Yeah, I think that it's really important that we look, anybody who's in this industry, to look at what's happened in the past, you can learn a lot about the functionality and the process of developing exploits by looking at the past. So you can break down the old ones and reverse engineer. In some cases, that's what we do in our reverse engineering courses, that we take old exploits and then try to alter them so that they will work in a different environment. That's what the whole reverse engineering malware industry is about. The CIA does it, the NSA does it, Unit 8200 in Israel does it, everybody does it. So there's no point in really creating new malware if you can take the old malware and make some tweaks to it and have it work in a different way and still be effective. So that's why it's important to understand these old ones. So it might be that by understanding EternalBlue, looking in depth at how it works, that you can go ahead and alter it, edit it, and make it work in a different environment, or at least the functionality in a different environment. OccupytheWeb, I really want to thank you as always for sharing. You make it so simple. We've had so much feedback on our videos about the way that you explain stuff. Keep it simple, even though you've got all this knowledge. So as always, thanks so much for sharing. Thanks, David, for having me. I always enjoy being on your show and I appreciate it. I enjoy sharing this information and trying to bring more and more people into our industry of cyber security. So that's fantastic. For everyone who's watching, please put your comments below, stuff that you want to see. We are thinking about Mr. Robot, more Mr. Robot, perhaps some more, SDR. Just let us know what you want. Metasploit, maybe more of that. Just, you know, put comments below, stuff that you want to see. OTW, thanks so much. Thanks, David.",
    "transcript_keywords": [
        "system",
        "Windows",
        "exploit",
        "SMB",
        "NSA",
        "Metasploit",
        "Windows machine",
        "Windows system",
        "Windows EternalBlue SMB",
        "exploits",
        "systems",
        "ahead",
        "Booz Allen Hamilton",
        "put",
        "work",
        "EternalBlue",
        "Master Hacker",
        "lot",
        "basically",
        "system admin"
    ],
    "transcript_entity_values": [
        "Microsoft",
        "Baltimore",
        "Avast",
        "Linux",
        "three",
        "9",
        "the NT Transact",
        "Apple Mac",
        "Marcus Hutchins",
        "32",
        "China",
        "Windows 8",
        "two",
        "Booz",
        "Ruby",
        "Linux Basics",
        "Metasploit 5",
        "17.010",
        "second",
        "YouTube",
        "EternalBlue Exploit",
        "Occupy the Web",
        "8",
        "the U.S. Department of Defense",
        "Python",
        "2018",
        "Transrequest",
        "EV",
        "Linux",
        "Windows seven",
        "Network Basics for Hackers",
        "MS17-010",
        "Russian",
        "Windows 7",
        "Bitcoin",
        "Windows 8 and",
        "Windows eight",
        "2024",
        "David Bombal",
        "Eternal Romance",
        "NT",
        "2013",
        "AV",
        "8.1",
        "IPC",
        "seven-year-old",
        "64",
        "2002",
        "Windows 7",
        "Israel",
        "2017",
        "today",
        "EternalBlue",
        "zero days",
        "Hacker's Arise",
        "OTW",
        "billions of dollars",
        "Russians",
        "2044",
        "one",
        "the Getting Started",
        "RAM",
        "Sean",
        "PDF",
        "the National Security Administration",
        "Petia",
        "early 2017",
        "Cali",
        "64",
        "zero day",
        "192.168.198.203",
        "Windows",
        "Benjamin Delpy",
        "66.512",
        "this tool years later",
        "RiskSense",
        "522",
        "MSB",
        "Booz Allen Hamilton",
        "first",
        "UK",
        "500",
        "2019",
        "Earth",
        "Mimikatz",
        "Getting Started Becoming a Master Hacker",
        "a hundred years",
        "Russia",
        "Meturperter",
        "days",
        "WannaCry",
        "March",
        "Metasploit 5",
        "Amazon",
        "the spring of 2017",
        "90%",
        "192.168.109",
        "years",
        "Windows",
        "Windows EternalBlue",
        "2020",
        "Avast",
        "David",
        "IP",
        "NSA",
        "this last couple of weeks",
        "SMB",
        "SQL",
        "Linux",
        "Hawaii",
        "Windows 64",
        "five years old",
        "2014",
        "Chinese",
        "Getting Started",
        "SDR",
        "the end of season one or season",
        "Bounds",
        "MSF",
        "168",
        "Windows 10",
        "First",
        "TikTok",
        "the winter of 2017",
        "US",
        "Marcus",
        "10",
        "WhatsApp",
        "Gentle Kiwi",
        "Metasploit",
        "millions of dollars",
        "at least three",
        "109",
        "445",
        "CIA",
        "U.K.",
        "seven",
        "Sean Dillon",
        "SearchSploit EternalBlue",
        "Hackers Rise",
        "this week",
        "Netflix",
        "five",
        "One",
        "Samba",
        "HashCat",
        "this last week",
        "JPEG",
        "Wireshark",
        "Snowden",
        "192",
        "Booz Allen Hamilton",
        "10",
        "Mimikatz",
        "Metasploit",
        "Kali",
        "Angela Merkel",
        "Angela",
        "Genghis Khan",
        "March of 2017",
        "Robot",
        "Eternal Blue",
        "U.S.",
        "Getting Started, Come Master Hacker",
        "Wireshark",
        "Edward Snowden",
        "seven years",
        "27",
        "SMB2",
        "NTFEA",
        "50"
    ],
    "transcript_entity_types": [
        "ORG",
        "GPE",
        "ORG",
        "ORG",
        "CARDINAL",
        "CARDINAL",
        "ORG",
        "ORG",
        "PERSON",
        "CARDINAL",
        "GPE",
        "PRODUCT",
        "CARDINAL",
        "ORG",
        "PERSON",
        "PERSON",
        "PRODUCT",
        "CARDINAL",
        "ORDINAL",
        "ORG",
        "ORG",
        "ORG",
        "CARDINAL",
        "ORG",
        "ORG",
        "DATE",
        "PERSON",
        "ORG",
        "GPE",
        "PRODUCT",
        "ORG",
        "DATE",
        "NORP",
        "PRODUCT",
        "NORP",
        "PRODUCT",
        "PRODUCT",
        "DATE",
        "PERSON",
        "WORK_OF_ART",
        "ORG",
        "DATE",
        "PRODUCT",
        "CARDINAL",
        "ORG",
        "DATE",
        "CARDINAL",
        "DATE",
        "ORG",
        "GPE",
        "DATE",
        "DATE",
        "ORG",
        "DATE",
        "WORK_OF_ART",
        "ORG",
        "MONEY",
        "NORP",
        "DATE",
        "CARDINAL",
        "ORG",
        "ORG",
        "PERSON",
        "ORG",
        "ORG",
        "ORG",
        "DATE",
        "GPE",
        "DATE",
        "DATE",
        "CARDINAL",
        "PRODUCT",
        "PERSON",
        "CARDINAL",
        "DATE",
        "ORG",
        "CARDINAL",
        "ORG",
        "ORG",
        "ORDINAL",
        "GPE",
        "CARDINAL",
        "DATE",
        "LOC",
        "PERSON",
        "WORK_OF_ART",
        "DATE",
        "GPE",
        "PERSON",
        "DATE",
        "ORG",
        "DATE",
        "LAW",
        "ORG",
        "DATE",
        "PERCENT",
        "DATE",
        "DATE",
        "ORG",
        "PRODUCT",
        "DATE",
        "PRODUCT",
        "PERSON",
        "ORG",
        "ORG",
        "DATE",
        "ORG",
        "ORG",
        "PERSON",
        "GPE",
        "ORG",
        "DATE",
        "DATE",
        "NORP",
        "WORK_OF_ART",
        "ORG",
        "DATE",
        "PERSON",
        "ORG",
        "CARDINAL",
        "PRODUCT",
        "ORDINAL",
        "ORG",
        "DATE",
        "GPE",
        "PERSON",
        "CARDINAL",
        "ORG",
        "PERSON",
        "PRODUCT",
        "MONEY",
        "CARDINAL",
        "CARDINAL",
        "CARDINAL",
        "ORG",
        "GPE",
        "CARDINAL",
        "PERSON",
        "WORK_OF_ART",
        "ORG",
        "DATE",
        "ORG",
        "CARDINAL",
        "CARDINAL",
        "ORG",
        "ORG",
        "DATE",
        "ORG",
        "PRODUCT",
        "PERSON",
        "CARDINAL",
        "PERSON",
        "DATE",
        "ORG",
        "ORG",
        "PERSON",
        "PERSON",
        "PERSON",
        "PERSON",
        "DATE",
        "PERSON",
        "ORG",
        "GPE",
        "WORK_OF_ART",
        "ORG",
        "PERSON",
        "DATE",
        "DATE",
        "ORG",
        "ORG",
        "CARDINAL"
    ]
}