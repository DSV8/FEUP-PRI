{
    "id": "7inhRWxQMFk",
    "title": "I Bought 25 Million Computer Viruses - VX Underground Malware HDD",
    "channel": "Linus Tech Tips",
    "channel_id": "UCXuqSBlHAE6Xw-yeJA0Tunw",
    "subscriber_count": 15900000,
    "upload_date": "2024-06-29T17:29:02Z",
    "video_url": "https://www.youtube.com/watch?v=7inhRWxQMFk",
    "category": "Science & Technology",
    "tags": [
        "Computer Security",
        "InfoSec",
        "Malware",
        "Virus",
        "Security Research",
        "LockBit",
        "ThreatLocker",
        "WannaCry",
        "Trojan",
        "Remote Access",
        "Conficker",
        "StuxNet",
        "CryptoLocker"
    ],
    "views": 1801721,
    "likes": 61497,
    "comments_count": 2392,
    "description": "Thank you ThreatLocker for helping with this video. If you want to learn more about Ringfencing and how to protect your network, start a free trial or book a demo:   We bought an external 8TB hard drive filled to the brim with malware from a faceless group of researchers known as VX Underground. What is on it? What can we do with it? What are OTHERS doing with it? Big thanks to smelly and lil cheezer for sending this to us.  Discuss on the forum:   Try Any.Run Interactive Sandbox   Purchases made through some store links may provide some compensation to Linus Media Group.   GET MERCH:   GET EXCLUSIVE CONTENT ON FLOATPLANE:   GET A VPN:   SPONSORS, AFFILIATES, AND PARTNERS:   EQUIPMENT WE USE TO FILM LTT:   OUR WAN PODCAST GEAR:   FOLLOW US  ---------------------------------------------------  Twitter:  Facebook:  Instagram:  TikTok:  Twitch:   MUSIC CREDIT --------------------------------------------------- Intro: Laszlo - Supernova Video Link:  iTunes Download Link:  Artist Link:   Outro: Approaching Nirvana - Sugar High Video Link:  Listen on Spotify:  Artist Link:   Intro animation by MBarek Abdelwassaa  Monitor And Keyboard by vadimmihalkevich / CC BY 4.0  Mechanical RGB Keyboard by BigBrotherECE / CC BY 4.0  Mouse Gamer free Model By Oscar Creativo / CC BY 4.0   CHAPTERS --------------------------------------------------- 0:00 Intro 1:52 Is this dangerous? 2:55 Borat 4:55 We're in 7:53 How does these rats do so much 10:30 What about Linux? 12:28 That's a little scary 14:25 How to protect yourself 16:38 This is almost too simple 19:38 Who is doing this? 21:18 How will we use this power?",
    "description_links": [
        "https://lmg.gg/TLock",
        "https://linustechtips.com/topic/1575157-i-bought-25-million-computer-viruses/",
        "https://app.any.run/?utm_source=youtube",
        "https://lttstore.com",
        "https://lmg.gg/lttfloatplane",
        "http://www.piavpn.com/linus",
        "https://lmg.gg/partners",
        "https://lmg.gg/LTTEquipment",
        "https://lmg.gg/wanset",
        "https://twitter.com/linustech",
        "http://www.facebook.com/LinusTech",
        "https://www.instagram.com/linustech",
        "https://www.tiktok.com/@linustech",
        "https://www.twitch.tv/linustech",
        "https://www.youtube.com/watch?v=PKfxmFU3lWY",
        "https://itunes.apple.com/us/album/supernova/id936805712",
        "https://soundcloud.com/laszlomusic",
        "https://www.youtube.com/watch?v=ngsGBSCDwcI",
        "http://spoti.fi/UxWkUw",
        "http://www.youtube.com/approachingnirvana",
        "https://www.instagram.com/mbarek_abdel/",
        "https://geni.us/PgGWp",
        "https://geni.us/mj6pHk4",
        "https://geni.us/Ps3XfE"
    ],
    "transcript": "This hard drive contains 25 million pieces of malware and this computer is about to become very, very sick. I mean, threat service has stopped. Windows Defender is completely disabled. But I guess that's what happens when you send $500 to a faceless person named Smelly who runs a shady network that collects, develops studies and reverse engineers nefarious code. So why did I do that? Because if you're trying to learn about computer security, this is probably the most valuable textbook you could find. It contains their entire repository of malware samples, research papers, blog posts from security researchers, and source code. Now, of course, it's all freely available on the VX Underground website, but the $500 isn't really for the content. It's a donation to ensure they can keep building this repository, which, wait, is that actually a good thing? Well... Let's talk about that. The single biggest hole in most security systems, computer or otherwise, is trust. New malware pops up every day, and defending against it is a never- ending game of... *pop* *pop* *pop* whack-a-mole that is such a constant churn of zero-day exploits and unpatched vulnerabilities that it's better to just assume the worst. That is why today's episode's sponsor, ThreatLocker, uses a zero- trust approach to security. Their endpoint protection platform works by assuming that applications are guilty until they're proven innocent, meaning that users within your organization can't just accidentally open the wrong email attachment or program installer and take down the entire company from the inside, leading to a whole bunch of really bad app like, oh, I don't know, maybe... The very first thing I asked when this video got pitched to me was, isn't this thing kind of dangerous to have lying around? And the answer is yes, but also no. These mostly aren't ready to go viruses, mostly. And while they absolutely can wreak havoc on your system if you're not careful, you don't really need to worry about doing a lock bit on yourself and encrypting your whole drive. Part of the reason for that is how things are stored. Most executables are missing the EXE file extension, so the system is far less likely to automatically run them, and everything else is in a password-protected 7-zip archive to prevent it from being automatically unpacked. Furthermore, many of these malwares are older, and the only real damage they can do to a fully updated system is by overloading Windows Defender's threat detection engine. That's what caused the weird behavior that you saw before. Of course, many of them- are still dangerous, and once you've got them decompressed and armed, all safety is completely out the windows. And also macOS and Linux. Borat Rat popped up in 2022 and was referred to as a \"triple threat\" because on top of granting remote access, it also includes DDoS and ransomware tools. This seems like exactly the kind of thing I would want to just run. Launch borat.7z archive in any run, Windows 10 or 11. This is Linux. Would you like me to show you any run? They do sandboxing. There's so much resetting and re-imaging and everything in this project. A fun one, right? Oh, it's just the best. Well, interesting at least, right? It's interesting. It's absolutely interesting. It's also extremely scary. I mean, it's not like you could single-handedly take down the whole company if you do anything irresponsible or careless. It is 10 or 11, so we'll do Windows 11 here. We'll run a public analysis. It's going to start uploading the file. We have 660 seconds to do this before it implodes. Implodes? Oh, this instance just goes away in 10, 11 minutes no matter what. That's correct. We're going to launch borad.exe. So if someone managed to execute this on your system, this is what would happen. This right here is actually the control panel for it, so this is what the hacker sees. Got it. And what I want to do right now is I'm going to go build a client for this. So I'm going to go just... Quickly here, build. All defaults, yep. Yeah, we'll choose an icon here. Let's give it the Borat Rat icon. Okay, so we are going to go build exe here. Client.exe is going to save into the Borat folder. And then what we should be able to do, and this works 50% of the time for me, is when we open up client.exe. So this will infect this instance. This is what we would try to remotely execute on the target system. Yeah, so we would try and remotely execute that, and you can see that we have done that. We've successfully infected ourselves. It's going to run systeminfo.exe, conhost, hostname.exe. It spit out absolutely everything that we want to know about this system. Here is everything about it, all in just this text file here, and this will get sent to the attacker. Probably as fun as it gets is in the utilities. So we can hide and show our taskbar, hide and show our desktop. What, just to mess with people? Yeah. Mouse is the best. Swap will swap around the left and right click. Dude. We can turn off the webcam light? Yep. Most webcams do work with the webcam light, just hardwired into the camera circuitry. But some of them don't, and that's where this is going to really exploit it. The other thing this is going to do is allow you to turn on their webcam light basically activating their camera, but not actually have to do anything. It's just a quick way of freaking them out if they're trying to make threats at you over the phone. . While you try and extort them for money. Fod Helper, watch how easy it is to get admin. You can see permission right here. It says permission user over on the right side. We're going to hit Fod Helper. It's going to restart the client. Look, admin. That's it. They haven't patched that yet. What are we running on? Yeah, 2021 second half. So this is pretty old Windows. That's good. That's really good that. That's still unpatched on this version, but it's probably patched somewhere else. I've not run this for real. I'm very afraid of it. Obviously, this dashboard here, right? There's a lot of lines. Yep. I mean, you could have a lot of clients and you could just poke around in one any time you want. What's surveillance do? Surveillance just lets you watch a little bit. You can remote shell, remote screen, remote camera, go into their file manager, you can record, you can get there. Their network information, see what processes are running. That's what you got here. Control. Control, so you can send files to them. Keylogger. Yep. Keylogger is built into every malware these days. Malware is where it gets real interesting. I just pick what malware I want. Yeah, you want to DDoS somebody, you can do that, especially if you've got a lot of bots there. You can ransomware them. So if you wanted to just do a lock bit on someone, you can just ransomware them like that. There is a way in here to steal credentials for Discord. It steals the session token for Discord so that you can gain access to somebody's Discord and then. Start messaging all their friends. Start messaging their friends with your client.exe, which you've just made look like whatever program you want, because that's part of the whole builder. And this is old, but it's not that old. It's still active in some regards. Maybe not this exact version, but clearly there's still people using it. And this kind of thing is only gonna get scarier and scarier when Windows 10 reaches end of life, dude. Mm-hm. Cuz so many people are gonna stay on Windows 10, and it's not gonna be getting security patches. Guys, patch your software. The stuff that gets patched isn't what really worries me, it's the zero days. There's so many zero days, and there's so much money in this now, especially with all of those hospitals getting ransomwared. Anyway, good luck. Practically speaking, there is no limit to what a creative attacker could do with something like Borat Rat. We haven't even touched on some of the basic functionality like exfiltrating data, popping up text messages so the attacker can communicate with the victim. But how does it do so much? Well, a big part of it is thanks to the DLL files that are included. These DLLs are mostly feature plugins that are taken from a fork of DC Rat called Santa Rat. When you really think about it, Rat does look a bit like a dirty wizard or a homeless Santa, but that's besides the point. The point is, if we run the Rat in a malware sandbox, like any run, which we're using here, we can get some idea of how it's executing individual exploits. Take the Fod Helper exploit, for example. How is it giving the Rat administrator privileges with almost no effort whatsoever? Well, we can see that it makes some registry changes before launching FodHelper, but what registry changes is it making exactly? Searching through the VxDrive, we can find the source code for it and see that it uses UAC bypass method 3 from options.dll. The source code for options.dll might be missing But as we know it came from Santa Rat So we can check the source code for that and see that it's modifying this key in the registry Even if we don't have any programming knowledge Just searching our virus drive for borat reveals several articles that summarize the threat in slightly more legible terms How can we use this though? Well, if we're a bad actor now we know a way to get to a command prompt window with admin privileges and we can exploit that But if we're a good actor, we know to set up something to watch that section of the registry in order to avoid this issue That is where today's episode sponsor Threatlocker comes in If we try to run this on a protected machine, Threatlocker will block the executable not because it's a known virus But because it's trying to execute at all our Threatlocker administrator account can now see it within response center Open it up in a virtualized testing environment to ensure that it's safe and either keep it on the block list Add it to the allow list outright or allow it with ring fencing just in case you're not sure about the application Ring fencing is the act of limiting what a program can do, like blocking it from connecting to the internet, blocking it from writing to the registry, accessing protected files, or interacting with high-risk applications like PowerShell and Command Prompt. After all, malware can't get access to an administrator command prompt if it can't open a command prompt at all. Coming back to our VX Underground drive though, being able to pwn Windows, not exactly a big accomplishment. Windows machines get hacked every day. What about Linux? Here's the thing. Web servers usually run Linux, and there's a lot of things that are trying to target that. A WordPress server is especially susceptible to attacks, like the C99 backdoor. Ooh, is it demo time? WordPress is often used by would-be webmasters because it is relatively user-friendly, at least on the surface, and free to use, but not all of the plugins are free, technically. Because of WordPress's GPL license, all derivative works, including plugins, are required to use GPL as well. That means that they can charge money, but they also can't stop people from sharing their code. So, websites that host cracked plugins aren't usually able to be taken down by lawyers. They do, however, often serve plugins with a little something extra that might make you want to pay for plugins from the official source. They can be used to host sketchy files, they can be used to ransomware your network, and once a backdoor is installed, other malware can be uploaded and potentially executed. Want to show us how it works? What I've done is gone ahead and just added our backdoor into one of the. Most generic websites of all time. Yeah. This is a default theme. The way that this could be replicated in real world, other than just through infected themes or plugins, is also through mismanaged upload credentials. So if you've got user uploads, they can potentially make this happen. This is what the back door actually looks like. So you can see that here we're going to local host into the themes folder, and we're just running this simple PHP file. And now we have access to everything. Wait, what? OK, so hold on a second. So my server is serving that website. That's correct. And you took advantage of a misconfigured upload permission setting. Yes. I just uploaded this file and. I have this. Yes. So this could be used to do any number of things. Let's say that your website was hosting, you know, a cool mod for something or a cool useful little application. I could go in and I could replace the file with something completely different. And if they don't bother to actually check the checksum that I publish on my site, although I could of course overwrite the checksum as well, then they could download a completely different file, execute that on their computer and boom, they're infected. And since everything is usually done with not the greatest encryption for PHP websites, usually, especially WordPress, the encryption on passwords is not great. You could just go in, grab the database, and then use, I don't know, your RTX 4090 at home to crack the passwords. Kind of like in the Wi-Fi cracking video. Right, you should check out that video if you haven't seen it already. Equally scary. Honestly, that's a little bit less scary than than some of these things because people can steal your Wi-Fi credentials But this will allow them to do stuff to you from anywhere sure But if they're on your network, then it's it's just so convenient at least you know they're nearby though. That's nice That's true. It means I'm not alone Now PHP is a just-in-time programming language So malware spreaders need to be a bit more creative than simply hiding it within a binary file That's where things like base 64 encoding and G sip come into play By converting everything into unreadable text that also fits into a single line in a code editor They can turn 5,000 lines of backdoor code into only 9 pretty lines of totally not suspicious at all gibberish If that gibberish code gets into a publicly accessible part of a web server either through misconfigured file upload permissions or nefarious WordPress plugins it can be executed by anyone who knows it's there With PHP's eval function, nefarious code can break out of the PHP container and start executing commands directly on the operating system Now, whoa whoa, hold on a second here Linus All this seems pretty irresponsible, are you guys really just trusting VX Underground and plugging this drive into a live system here? The answer is no, and of course not Even though we're not using any run here like we were with Windows Our sponsor ThreatLocker would never forgive us if we just blindly gave out trust I mean, that's the antithesis of the zero trust model Trusting a stranger is the number one way to get pwned No worm or backdoor can ever match the effectiveness of a social engineering attack So if a guy named Smelly tells you that the drive he gave you contains lots and lots of malware You should probably believe him and take the necessary precautions, but what are they? Well to start with we set up our Linux machine to be air gapped Okay to clarify, no system is completely immune and it was only a few months ago that the popular compression library XZ was found to contain a back door but desktop Linux is less likely to be attacked with simple automated malware. As for air gapping, this refers to the practice of isolating a computer from the rest of your networked machines and it can be simulated with VLANs, but if you want to be sure, I'd recommend just unplugging it. VLAN hopping isn't a huge risk these days. But it isn't impossible. Of course, if you want to step up your safety a level further, you need a malware sandbox, a virtual machine on a virtual network that is completely isolated from any other machine and that will be destroyed the moment that you no longer need it. ThreatLocker has their testing environment feature that allows you to pass executables that are quarantined from your protected computers into their sandbox without any runs overly restrictive time limit or the requirement to make your sample public. Now, we're using AnyRun for deeper dives right now simply because it allows us to upload our samples directly, but ThreatLocker's Response Center is more than adequate for 99% of use cases. The two products, the sponsored one and the other one, actually complement each other really nicely to fill different sandboxing needs. ThreatLocker is great for production environment work, while AnyRun is better suited for noodling around. Shall we noodle some more? Hey, look, it's the chief noodler himself. What are we looking at now? Ooh, lock bit. Yeah, we're gonna take a quick look at lock bit. So I'm told it's shocking how simple it actually is That's in the script This is super cool. This is a paid version of AnyRun. Yes. Okay, did they send that over to us? They did Hey shout out AnyRun. Thanks So we're doing the same thing we did before I rat We're gonna drag it out of here and I did not password protect this one Tanner Hey if we get infected I don't own the company so here we've got just some configuration things local disks true network shares true it makes my skin crawl just thinking about something like this getting on our network oh have I clarified that it's a ransomware well it's a ransomware if I didn't say that already so now we've got our decrypter mm-hmm we've got password dot DLL so that's the decryption password here if If it is executed through DLL the exe version is a slightly different password, but yeah, it's it's essentially Here's the here's the encryptor and then here's the key that you can provide to the victim in Whatever form you like yeah what a lot of people have been doing lately is accepting the payment from their victims And then not decrypting so that is an option too That is a whole other level of f***. yeah, so if you were to run Lb3.exe And yeah, you've now lost everything that was quick It actually looks you can set what kinds of files it looks for off the bat so you can aim for Databases first if you want, which is what a lot of places are going after more of a commercial entity Yep, see this is the kind of thing we cover on WAN show and we talk about in the news and we discuss But there's a big difference between, you know, sort of talking about what's out there and these high-profile attacks and just seeing how simple the tools are. I could do this. You want to know how simple some of these are? You know the WannaCry virus. That was the one that was... That was the ransomware that was just all over the place for several years there. It got defeated when somebody went in to the source code for it, did a whole decompilation, found... found a line of code in there that kept calling one particular website address, so they decided to buy the domain, because it hadn't been registered. Apparently that domain was just being used by WannaCry as a kill switch, so they accidentally stopped WannaCry, the guy ended up... getting caught by the FBI for credit card fraud that he did earlier in his life, and then the judge at judgment was like \"Meh, you know what, the public good that you've done kind of outweighs whatever credit card fraud.\" So if you're gonna commit credit card fraud, also stop the worst ransomware attacks in history. Of course, the groups that are executing ransomware attacks be they... WannaCry or LockBit or something else aren't just using ransomware. They need to find a way to infiltrate their target's organization, spread it around, and remain undetected. And many of these tasks require some level of social engineering. So what might start as a phishing attack could then transition into a rat being planted, which can then be used to plant the ransomware. Borat Rat isn't its own ransomware necessarily, but rather it's a vessel for carrying many payloads, one of which happens to be LockBit-style ransomwares. And all of this is being accomplished by several competing groups. Some are simply trying to cash in, but some clearly have other goals in mind, as there's strong evidence that many malware groups operate as part of government entities. North Korea's Lazarus Group, Russia's Berserk Bear, and America's NSA Equation Group are just a few suspected examples. So, is this hard drive only for researchers, or could somebody conceivably use this repository? to create and spread malware, possibly in an act of state-sponsored terrorism? Don't kid yourself. This is on the blacker side of gray, and the only moral justification for its existence is that, realistically, the bad guys have access to this information anyway, and by shedding light on it, we're at least giving the good guys a hoping chance to counter any upcoming threats. Security through obscurity is a pipe dream, and- Just like we probably upset some gas station owners when we made our video on the Flipper Zero, we're probably ruffling some feathers with this one, but we feel it's a valuable conversation to start, and one that we should keep on having. The last question you guys might be asking is, \"What are we planning to do with the VX Underground hard drive?\" Well, the first thing is to put a warning label on it, maybe even a bigger one than this, and then after that... I don't know, we've actually had some really cool ideas for videos in the past that have required us to intentionally infect a system. But, providing real malware to us is against the policy of every white hat organization and person that we have ever interacted with. So, we have struggled at times to create, for example, an infected system to bring to a shop for servicing. If you have any other ideas, we're open to them, but for now, we're gonna fester on it for a little bit, and... Seeing the kinds of threats that are not only out there, but more numerous than I previously imagined. I guess we'll look into hardening our security, maybe with some help from our sponsor, ThreatLocker. If you guys liked this video, why don't you check out the time we bought anti-virus USB sticks from Facebook? They were, they were USB sticks, all right?",
    "transcript_keywords": [
        "Rat",
        "malware",
        "Windows",
        "Borat Rat",
        "run",
        "code",
        "ransomware",
        "system",
        "thing",
        "file",
        "Yeah",
        "ThreatLocker",
        "source code",
        "bit",
        "Windows Defender",
        "Linux",
        "things",
        "security",
        "Santa Rat",
        "drive"
    ],
    "transcript_entity_values": [
        "one",
        "Threatlocker",
        "VxDrive",
        "every day",
        "Tanner",
        "Response Center",
        "VX Underground",
        "WordPress",
        "Discord",
        "DC",
        "zero",
        "Windows 10 or 11",
        "Borat",
        "25 million",
        "DDoS",
        "FBI",
        "2021 second half",
        "C99",
        "Lazarus Group",
        "64",
        "ThreatLocker",
        "Facebook",
        "Lb3.exe",
        "Linus",
        "Linux",
        "VLAN",
        "Wi-Fi",
        "10 or 11",
        "Russia",
        "LockBit",
        "XZ",
        "first",
        "2022",
        "Windows Our",
        "Santa Rat",
        "Windows 10",
        "FodHelper",
        "10, 11 minutes",
        "50%",
        "the zero days",
        "DLL",
        "North Korea's",
        "Windows",
        "the Flipper Zero",
        "the VX Underground",
        "several years",
        "Smelly",
        "GPL",
        "5,000",
        "3",
        "only 9",
        "Fod Helper",
        "Linux",
        "two",
        "99%",
        "Berserk Bear",
        "these days",
        "webcam",
        "PHP",
        "second",
        "Threatlocker",
        "only a few months ago",
        "660 seconds",
        "PowerShell",
        "America",
        "today",
        "Windows Defender",
        "Windows 11",
        "Windows Defender's",
        "zero-day",
        "AnyRun",
        "NSA Equation Group",
        "500",
        "WAN",
        "USB",
        "Client.exe",
        "Linux",
        "Santa",
        "WannaCry"
    ],
    "transcript_entity_types": [
        "CARDINAL",
        "PERSON",
        "PERSON",
        "DATE",
        "PERSON",
        "ORG",
        "FAC",
        "ORG",
        "ORG",
        "GPE",
        "CARDINAL",
        "PRODUCT",
        "PERSON",
        "CARDINAL",
        "ORG",
        "ORG",
        "DATE",
        "PRODUCT",
        "ORG",
        "CARDINAL",
        "ORG",
        "ORG",
        "PERSON",
        "PERSON",
        "ORG",
        "ORG",
        "LOC",
        "DATE",
        "GPE",
        "ORG",
        "ORG",
        "ORDINAL",
        "DATE",
        "PRODUCT",
        "GPE",
        "PRODUCT",
        "ORG",
        "TIME",
        "PERCENT",
        "DATE",
        "ORG",
        "GPE",
        "PRODUCT",
        "PRODUCT",
        "FAC",
        "DATE",
        "PERSON",
        "ORG",
        "CARDINAL",
        "CARDINAL",
        "CARDINAL",
        "ORG",
        "PERSON",
        "CARDINAL",
        "PERCENT",
        "PERSON",
        "DATE",
        "FAC",
        "ORG",
        "ORDINAL",
        "ORG",
        "DATE",
        "TIME",
        "ORG",
        "GPE",
        "DATE",
        "PRODUCT",
        "PRODUCT",
        "ORG",
        "DATE",
        "GPE",
        "ORG",
        "MONEY",
        "ORG",
        "ORG",
        "PERSON",
        "GPE",
        "GPE",
        "ORG"
    ]
}