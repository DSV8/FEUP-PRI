{
    "id": "qMnPgJoF5YE",
    "title": "Hacking ARP with Python and Kali Linux (and capture passwords)",
    "channel": "David Bombal",
    "channel_id": "UCP7WmQ_U4GB3K51Od9QvM0w",
    "subscriber_count": 2650000,
    "upload_date": "2024-10-13T14:00:48Z",
    "video_url": "https://www.youtube.com/watch?v=qMnPgJoF5YE",
    "category": "Science & Technology",
    "tags": [
        "arp",
        "mitm",
        "wifi",
        "hacker",
        "hack",
        "hacking",
        "man in the middle",
        "passwords",
        "kali linux",
        "kali linux tutorial",
        "kali linux install",
        "kali linux basics",
        "kali linux tutorial for beginners",
        "kali linux hacking tutorials",
        "ethical hacking",
        "ethical hacking tutorial",
        "ethical hacking free course",
        "ethical hacking course",
        "how to become a hacker",
        "ccna",
        "ccna 200-301",
        "linux tutorial",
        "ccna study",
        "kali",
        "ettercap",
        "password capture",
        "wireshark",
        "password hack",
        "password crack",
        "python arp",
        "python mitm",
        "python hack"
    ],
    "views": 33366,
    "likes": 1383,
    "comments_count": 83,
    "description": "Big thanks to Brilliant for sponsoring this video!  To try everything Brilliant has to offer for free for a full 30 days and 20% discount visit:   It's so easy to hack badly configured networks using Kali Linux. Both Wifi and Ethernet networks rely on protocols such as Address Resolution Protocol (ARP) to function, but they can be easily manipulated using Kali Linux and a Python script. The Cisco CCNA course discusses this topic and explains how to use Dynamic ARP Inspection (DAI) to stop these kinds of attacks. I highly recommend that you learn Python - it will give you great power (but with great power comes great responsibility).   Make sure you have configured your networks securely! Otherwise, look at how simple it is to hack networks using Kali Linux running on a Windows 11 computer. Applications like Ettercap make hacking with Kali Linux super easy, but you can also use Python to create your own tools! It's important that you as a network professional know how to protect networks from hackers. The new Cisco CCNA 200-301 exam covers some of these hacking topics. Don't just learn the theory of hacking, learn how hacks work practically.   In this Ethical Hacking CCNA video, I'm going to show you step by step how to hack and protect networks. This is white-hat hacking, not black-hat -  in other words this is about teaching you Ethical hacking to help you better secure your networks!  In this video I'll show you how to poison the ARP cache of a Windows 11 computer and then implement a Man in the middle (MITM) attack so you can see all data sent between the Windows 11 computer and it's default gateway. In subsequent videos I'll show you how to protect networks as as well as how to hack other protocols.  // GitHub Code //   // FREE CCNA Complete Practical Course // Expect regular updates - the full course will be uploaded on my Tech Channel here:   // David's SOCIAL //  Discord:   X:   Instagram:   LinkedIn:   Facebook:   TikTok:   YouTube:   // MY STUFF //     // SPONSORS //  Interested in sponsoring my videos? Reach out to my team here: sponsors@davidbombal.com   // Menu // 0:00 - Intro 1:18 - Brilliant Ad 3:35 - Topology 5:43 - Demonstration (Windows 11) 8:25 - Kali Linux 12:58 - Python Script Explained (Wireshark) 15:24 - Testing Telnet On The Cisco Router  18:50 - Why You should Use Encrypted Protocols 19:22 - Where is ARP Used 19:43 - Conclusion 19:58 - Outro  arp wifi mitm password passwords wireshark ccna hack hacking hacker kali linux Hacking Ethical hacking CCNA  Please note that links listed may be affiliate links and provide me with a small percentage/kickback should you use them to purchase any of the items listed or recommended. Thank you for supporting me and this channel!   Disclaimer: This video is for educational purposes only.  #kalilinux #wifi #hacker",
    "description_links": [
        "https://Brilliant.org/DavidBombal",
        "https://github.com/davidbombal/red-python-scripts/blob/main/arp_mitm.py",
        "https://davidbombal.wiki/freeccnayt",
        "https://discord.com/invite/usKSyzb",
        "https://www.twitter.com/davidbombal",
        "https://www.instagram.com/davidbombal",
        "https://www.linkedin.com/in/davidbombal",
        "https://www.facebook.com/davidbombal.co",
        "http://tiktok.com/@davidbombal",
        "https://www.youtube.com/@davidbombal",
        "https://www.amazon.com/shop/davidbombal"
    ],
    "transcript": "this video is part of my complete practical CCNA course where I'm showing you how to configure Cisco devices in preparation for the CCNA exam but I'm not using emulators or simulators I'm using real Cisco devices such as the Cisco 9200CX switch in other words I'm not just using old devices I'm using very modern Cisco devices to show you how things actually work so that you can pass the CCNA exam but also go out there and make a success in the real world in this video I'm going to show you how to hack a network using a Python script now in this example I'm using physical ethernet but the script can also be used on a Wi-Fi network you need to understand how ARP works for the CCNA exam but also for the real world in this video we're going to be covering Dynamic op inspection this is part of 5.7 in the CCNA version 1.1 exam in this first video I'm going to show you how to hack ARP using a Python script the Python script is going to be used to hack this physical network using physical ethernet connectors but the same Python script can be used to hack Wi-Fi networks so in this first video I'll show you how to hack op and in the next video I'll show you how to enable Dynamic op inspection to stop this kind of nonsense now you don't have to learn Python for the CCNA exam but I highly recommend that you do learn it for the real world and a great place to learn Python is Brilliant they have many courses including programming with python this is a level two course or applied Python which is a computer science and programming level four course what I really like about brilliant is their content is very interactive rather than just passively watching a video as an example you are involved in your learning so as an example can you solve this question number = 2 print (number + number + number) what's the answer? Answer in this example would be 6 and there you go I got that right I'll click continue what about this one length = 10 width = 12 print (length x width) what's the answer? answer is 120 notice how interactive this is now you may find that those questions are too easy but notice as you go through the training the questions get harder as you go deeper into Python as an example they have a section practice conditions in loops so this is a little bit more difficult what condition should be inserted on line 2? The output should classify even and odd values so for n in range (4) add a condition here print n is even else print n is odd what's the answer so I'll just randomly check that option and notice we told that that's incorrect the correct answer is this again notice how interactive the training is Brilliant to take you through different modules starting at the beginning going deeper and deeper into Python I highly recommend that you learn python for the real world Brilliant once again is a great way to start your journey use my link below to get get a special discount I really want to thank Brilliant for sponsoring this video and supporting my channel my free CCNA course wouldn't exist if it wasn't for sponsorships from companies like brilliant who are really a Brilliant company to work with fantastic partner I really want to thank them once again for supporting me and helping me create more free content to hopefully help you change your life to try everything that Brilliant has to offer for free for 30 days visit https://Brilliant.org/DavidBombal or scan the QR code on screen or click on the link in the video description you'll also get 20% off an annual premium subscription this is what our topology looks like I've got a Kali Linux virtual machine running on this Windows computer it's connected to the 9200CX switch on gigabit 1/0/1 right over here I've got a Windows 11 computer that Windows computer at the top there it's connected to gigabit 1/0/1 on the 9200CX switch and then I've got a Cisco router over here connected to gigabit 1/0/2 on the Cisco switch now ARP is required in Ethernet and Wi-Fi networks because devices need to learn the MAC address of the devices that they're communicating with as an example if this Windows computer wants to send traffic to the internet it will need to know the MAC address of the router so that frames can be sent on the ethernet Network so at layer 2 in the OSI or TCP IP model we've got ethernet it's going to be using a MAC address at layer three we've got an IPv4 address as an example or IPv6 when this Windows computer sends traffic onto the internet for example going to google.com it needs to know the layer 2 Mac address of its default gateway and what we're going to do in this topology is hack that so that the Kali Linux machine replaces the MAC address used by Windows 11 to get to its default gateway so what's essentially going to happen is traffic is going to be sent via Kali to the router to get to the internet allowing us to sniff all usernames and passwords and any other traffic that's sent in clear text this is why you don't want to use clear text protocols in today's networks you want to use encrypted protocols so as an example you want to use TLS rather than HTTP you want to use SSH rather than telnet a very bad idea to use these kind of protocols in networks today now talking and PowerPoints are okay I suppose but much better I think for me toc demonstrate this practically so on my Windows 11 computer at the top there I'll open up Powershell type ipconfig what you'll notice is ethernet 2 on this computer has this IP address 192.168.1.6 that IP address was allocated by this Cisco router using DHCP so on the router if I type show ip dhcp bindings you can see this IP address was allocated to a device with Mac address ending in d321.f so on this computer let's do ipconfig /all we can see more information now ethernet 2 has this Mac address d321.3F and again that's the MAC address we see in DHCP so that IP address was allocated to the Windows computer we can see IP address here we can see default gateway we can see DHCP Server notice default gateway is 192.168.1.254 which is the Cisco router so VLAN1 on the Cisco router has this IP address 192.168.1.254 what I've done here is connect the switch using this gray cable to one of the ports on the Cisco router these are layer 2 ports as in the router has a built-in switch so hence the IP address being configured on VLAN 1 show int vlan 1 what's important to note here is the MAC address it ends in a674 on the Windows computer I'll clear the screen type arp-a 192.168.1.254 has a MAC address ending in -12-a6-74 so the PC has learned the MAC address of its default gateway default gateway once again has this Mac address 12-a6-74 so when the Windows computer goes to a website such as Davidbombal.com that traffic is going to be forwarded via its default gateway so once again the Windows 11 computer to get to the internet is sending traffic to its default gateway we are now going to manipulate that using a Python script so that traffic is forwarded to Kali and then on to the default gateway allowing us to capture all traffic sent between Windows and its default gateway now just note you don't have to know the Python script for the exam but hackers can easily use a script like this or other applications to intercept traffic on layer 2 networks both wired as well as Wireless so on Kali Linux over here I'm going to open up my home directory what I want you to notice here is there is no pcap file shown at the moment but when we run our Python script it's going to capture packets and save those packets in a file allowing us to view usernames and passwords and other information sent in clear text so I'll open up a terminal ls shows us the script arp_mitm.py if it's a fairly long script this script is available on my GitHub if you search for David Bombal red-python-scripts or arp_mitm python script you'll find this script and you'll be able to copy and download it as always only use scripts like this for testing and evaluation purposes only attack networks that you own or have permission to attack now we told in the script that we have to use this command sudo to give us root privileges Python 3 to run Python 3 the name of our script and then we have to specify an IP range that we're going to attack so in our example it's going to be 192.168. 1.0/24 the script uses scapy and a bunch of other options to capture packets off the wire and change the arp caches of our computers again you don't have to know this script for the CCNA exam but for the real world I'd strongly recommend that you learn Python so here I'll type less arp_mitm.py and as you can see there here is our script and again I won't bore you going through the entire script you don't need to know that for the exam so type sudo python3 arp_mitm.py our range is this because on our DHCP pool if I type show IP dhcp pool that is the range of IP addresses that are being allocated via DHCP now just before I run that script notice on the Windows computer if I type arp -a our ARP cache is showing that this IP address is mapped to this Mac address but that's going to change once we run a Python script sudo python3 our script and our subnet I'll put in my sudo password and what you'll notice now is that we asked to specify the device that we're going to attack so the device that I want to attack is 192.168.1.6 that's once again this Windows computer if I open up a new tab here and type ipconfig notice IP address 192.168.1.6 and if I'll look at the MAC address it ends in -D3-21-3F and there it is so I'll select zero to attack that device and notice it says writing to pcap file press ctrl c to exit so if I have a look at my home directory notice this requests.pcap file has now been saved and if I open that up with Wireshark you can see a bunch of traffic is being sent into the network so we can see ARP traffic here a bunch of ARP messages and other messages are being sent into the network I'll close that down and let the script run what I want you to notice and this is the important piece is previously this IP address was mapped to this Mac address if I open up another tab now and type arp -a what you'll notice is this IP address is now mapped to a different Mac address so previously it was mapped as follows now it's mapped to this Mac address ending at 5e-d9-1c and if I open up another command prompt on Kali and type IP address what you'll notice is that's the MAC address of the Kali machine 5e:d9:1c over there that means that we've poisoned the ARP cache of this Windows 11 computer making it believe that Kali is the default gateway so it believes that 192.168.1.254 is using this Mac address rather than the real Mac address so all traffic will therefore be sent via Kali to the internet as an example now how is the Python script doing that we can see what's going on by opening up a Wireshark capture on the Windows computer the interface that has this IP address is ethernet 2 so I'll capture traffic on ethernet 2 I'll zoom in here a bit and what you'll notice is there's a bunch of traffic being sent but the important piece is op what you'll see here is VMware is telling Dell that Dell computer at the top that 192.168.1.254 uses this Mac address 5e:d9:1c so we are basically poisoning the ARP cache saying that this IP address is using this Mac address but in actual fact this IP address is configured on the Cisco router not on VMware so the Dell computer with this IP address 192.168.1.6 thinks that 1.254 uses this Mac address so as simple as that we are basically poisoning the ARP cache of the Windows computer I'll stop this capture so that it looks like this now this is known as a gratuitous op where a device in this case the VMware virtual machine is updating the Dell laptop with its new Mac address for this IP address so it's basically telling the Dell device update your ARP cache with this new Mac address for the mapping of IP to MAC address now the are legitimate uses for this if a device changes its Mac address as an example it needs to tell devices on the network what its new Mac address is so it would send out a gratuitous ARP like this but in this example this is used maliciously because Kali Linux running within VMware is telling the network that this is the new Mac address for this IP address which is obviously incorrect the MAC address for 1921.168.1.254 isn't that it's actually this Mac address so we are attacking or poisoning the ARP cache on the Dell machine so that it sends all traffic to the Kali machine instead of to the local router okay that's all right but let's try and do something so what I'll do is open up putty on the Windows computer and let's assume the administrator did something really dumb and allowed telnet to the Cisco router so I'll telnet to the Cisco router to its loopback address on The Cisco router show ip int brief we can see this IP address is configured on the loop back so what I'll do is telnet to that IP address and we asked to put in a password so I'll put a password in put an enable password in and let's type showrun so I'm basically showing the config of the router now really bad idea because I'm using telnet so on Kali I'll open up this pcap file and then what I'll do is search for telnet and as you can see there there's telnet data sent between 192.168. 1.6 the Windows computer and the loop back of the Cisco router and we could go through this output and look for stuff and what you'll notice right there cisco that that's the password on the vty line here I pressed return notice the prompt is shown then I typed en n to go to enable mode pressed carriage return router asked for the password I put it in cisco so I've been able to capture the passwords it's a lot easier however to go to follow TCP stream and right over there you can see the password cisco and cisco okay that might not be so clear so what I'll do is copy that and I'll paste that in here so scrolling all the way up there's the telnet password typed enable I'm capturing traffic in both directions so I'm seeing the E typed from the PC to the router and the router echoing back the output there's the enable password typed show run and notice here has the whole configuration showing the enabled password scrolling down all the config of the router is shown here including the password on the vty line don't use telnet in today's networks okay but let's make it even worse let's assume that we use HTTP to go to another router so this is another Cisco router it's actually connected on the other side of the Cisco router so it's part of my lab I'll type the username cisco cisco and as you can see there we can see some output of the router back on Kali Linux I'll close this down on and open it up again and let's search for htttp so we can see some HTTP going to various websites there's 1.6 going to 192.168.32.49 which is the one we're interested in and we can have a look at the output here we can see that it's Windows nt10 64-bit architecture we can see that we're connecting to a Cisco router scrolling down some information is shown here the part I'm interested in is authorization credentials cisco cisco those are the credentials for another Cisco router in my infrastructure captured by Kali because the traffic is going via that device to get to the router so we can essentially see everything again this is why you want to use encrypted protocols such as SSH or TLS you don't want to use telnet or HTTP in today's networks this is another reason why you'll see warnings out there about using public Wi-Fi networks because you could be connecting to a Wi-Fi network rather than a physical Network so your phone as an example could be connected to a public Wi-Fi network and someone could be running Kali Linux and capturing traffic through that Network this script once again works on both wired as well as wireless networks ARP is used both on Wi-Fi as well as physical ethernet like this so the script will work on both of those so what we need to implement in our network is dynamic ARP inspection where we validate address resolution packets or ARP packets in a network to make sure that we stop man-in-the-middle attacks and I'll cover that in the next video hopefully you enjoyed this video hopefully you've learned something again Dynamic ARP inspection allows us to stop these kind of attacks where ARP caches are poisoned and hackers can run man-in-the-middle attacks to capture traffic on both a wired as well as a Wi-Fi network",
    "transcript_keywords": [
        "MAC address",
        "Cisco router",
        "Windows computer",
        "Python script",
        "Mac address ending",
        "address",
        "MAC",
        "Cisco",
        "Kali Linux",
        "real Mac address",
        "cisco cisco",
        "Python",
        "username cisco cisco",
        "ARP",
        "Windows",
        "Cisco router show",
        "dynamic ARP inspection",
        "credentials cisco cisco",
        "configure Cisco devices",
        "modern Cisco devices"
    ],
    "transcript_entity_values": [
        "first",
        "three",
        "TLS",
        "6",
        "cisco",
        "SSH",
        "Mac",
        "120",
        "1.254",
        "annual",
        "192.168.1.6",
        "Cisco",
        "Wi-Fi",
        "ARP",
        "12",
        "5.7",
        "two",
        "four",
        "4",
        "Windows nt10",
        "Wireshark",
        "Python for the",
        "Kali Linux",
        "Windows",
        "Dell",
        "1.1",
        "2",
        "zero",
        "5e",
        "192.168",
        "Network",
        "3",
        "1/0/1",
        "today",
        "192.168.32.49",
        "Powershell",
        "IP",
        "VLAN",
        "Python",
        "Kali",
        "cisco cisco",
        "Mac",
        "VLAN1",
        "5e-d9-1c",
        "one",
        "9200CX",
        "30 days",
        "192.168.1.6",
        "VMware",
        "Windows 11",
        "MAC",
        "Wireless",
        "ARP",
        "Python",
        "Cisco",
        "CCNA",
        "Davidbombal.com",
        "https://Brilliant.org/DavidBombal",
        "Kali Linux",
        "vty",
        "20%",
        "Windows",
        "OSI",
        "DHCP",
        "Dynamic",
        "1",
        "192.168",
        "David Bombal",
        "Wi-Fi",
        "1.6",
        "10",
        "1921.168.1.254",
        "a674"
    ],
    "transcript_entity_types": [
        "ORDINAL",
        "CARDINAL",
        "ORG",
        "CARDINAL",
        "GPE",
        "ORG",
        "ORG",
        "CARDINAL",
        "CARDINAL",
        "DATE",
        "DATE",
        "ORG",
        "LOC",
        "ORG",
        "CARDINAL",
        "CARDINAL",
        "CARDINAL",
        "CARDINAL",
        "CARDINAL",
        "PRODUCT",
        "PRODUCT",
        "WORK_OF_ART",
        "ORG",
        "ORG",
        "ORG",
        "CARDINAL",
        "CARDINAL",
        "CARDINAL",
        "CARDINAL",
        "PRODUCT",
        "ORG",
        "CARDINAL",
        "ORG",
        "DATE",
        "CARDINAL",
        "ORG",
        "ORG",
        "ORG",
        "ORG",
        "PERSON",
        "ORG",
        "PERSON",
        "PERSON",
        "ORG",
        "CARDINAL",
        "CARDINAL",
        "DATE",
        "CARDINAL",
        "ORG",
        "PRODUCT",
        "ORG",
        "ORG",
        "PRODUCT",
        "WORK_OF_ART",
        "GPE",
        "ORG",
        "ORG",
        "DATE",
        "PERSON",
        "ORG",
        "PERCENT",
        "PRODUCT",
        "ORG",
        "ORG",
        "NORP",
        "CARDINAL",
        "CARDINAL",
        "PERSON",
        "ORG",
        "CARDINAL",
        "CARDINAL",
        "DATE",
        "ORG"
    ]
}